var O,w=(e,n,t=new Set)=>(n={get value(){return O?.deps.push(t.add(O)),e},set value(r){if(r!==e){e=r;for(let s of t)s()}},peek(){return e}},n.toJSON=n.then=n.toString=n.valueOf=()=>n.value,n),x=(e,n,t,r)=>(t=s=>{n?.call?.(),s=O,O=t;try{n=e()}finally{O=s}},r=t.deps=[],t(),s=>{for(n?.call?.();s=r.pop();)s.delete(t)}),R=(e,n=w(),t,r)=>(t={get value(){return r||(r=x(()=>n.value=e())),n.value},peek:n.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),$=e=>e(),q=$,U=e=>(w=e.signal,x=e.effect,R=e.computed,$=e.batch||$,q=e.untracked||q),v=Symbol("signals"),N=Symbol("change"),E=(e,n)=>{if(!e||e[v])return e;if(Array.isArray(e))return Y(e);if(e.constructor!==Object||e[Symbol.toStringTag])return e;let t={...n?.[v]},r=w(Object.values(e).length);const s=new Proxy(t,{get:(o,i)=>i===N?r:i===v?t:t[i]?.valueOf(),set:(o,i,c,a)=>(a=t[i],P(t,i,c),a??++r.value,1),deleteProperty:(o,i)=>(t[i]&&(t[i][Symbol.dispose]?.(),delete t[i],r.value--),1),ownKeys:()=>(r.value,Reflect.ownKeys(t))});for(let o in e){const i=Object.getOwnPropertyDescriptor(e,o);i?.get?(t[o]=R(i.get.bind(s)))._set=i.set?.bind(s):(t[o]=null,P(t,o,e[o]))}return s},Y=e=>{let n;if(e[v])return e;let t=w(e.length),r=Array(e.length).fill();const s=new Proxy(r,{get(o,i){if(typeof i=="symbol")return i===N?t:i===v?r:r[i];if(i==="length")return ee.includes(n)?t.peek():t.value;if(n=i,r[i])return r[i].valueOf();if(i<r.length)return(r[i]=w(E(e[i]))).value},set(o,i,c){if(i==="length"){for(let a=c;a<r.length;a++)delete s[a];return t.value=r.length=c,!0}return P(r,i,c),i>=t.peek()&&(t.value=r.length=+i+1),!0},deleteProperty:(o,i)=>(r[i]?.[Symbol.dispose]?.(),delete r[i],1)});return s},ee=["push","pop","shift","unshift","splice"],P=(e,n,t)=>{let r=e[n];if(n[0]==="_")e[n]=t;else if(!r)e[n]=r=t?.peek?t:w(E(t));else if(t!==r.peek())if(r._set)r._set(t);else if(Array.isArray(t)&&Array.isArray(r.peek())){const s=r.peek();s[N]?$(()=>{for(let o=0;o<t.length;o++)s[o]=t[o];s.length=t.length}):r.value=t}else r.value=E(t)},F=E,J=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),m=Symbol("state"),C=Symbol("on"),T=Symbol("off"),D={},h=(e,n,t=K)=>D[e]=(r,s,o,i,c,a)=>(a=t(s),c=n(r,o,s,i,a),()=>c(a(o)));function A(e,n){if(e[m])return Object.assign(e[m],n);const t=E(n||{}),r=[],s=[],o=(i,c=i.attributes)=>{if(c)for(let a=0;a<c.length;){let{name:p,value:g}=c[a],l,u,d;if(l=p[0]===":"?1:p[0]==="s"&&p[1]==="-"?2:0){i.removeAttribute(p);for(d of p.slice(l).split(":"))if(u=(D[d]||D.default)(i,g,t,d),s.push(u),r.push(x(u)),i[m]===null)return}else a++}for(let a of i.childNodes)a.nodeType==1&&o(a)};return o(e),m in e||(e[m]=t,e[T]=()=>{for(;r.length;)r.pop()()},e[C]=()=>r.push(...s.map(i=>x(i))),e[J]=()=>(e[T](),e[T]=e[C]=e[J]=e[m]=null)),t}var K=(e,n,t)=>{if(t=V[e=e.trim()])return t;try{t=H(e)}catch(r){B(r,n,e)}return V[e]=t},V={},B=(e,n="",t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${n}${t?`="${t}"

`:""}`,expr:t})},H;A.use=e=>{e.signal&&U(e),e.compile&&(H=e.compile)};var W=e=>{if(!e.nodeType)return e;let n=e.content.cloneNode(!0),t=[...e.attributes],r=document.createTextNode(""),s=(n.append(r),[...n.childNodes]);return{childNodes:s,content:n,remove:()=>n.append(...s),replaceWith(o){o!==r&&(r.before(o),n.append(...s))},attributes:t,removeAttribute(o){t.splice(t.findIndex(i=>i.name===o),1)}}},X=Symbol("if");h("if",(e,n)=>{const t=document.createTextNode("");let r=e.nextElementSibling,s,o,i;return e.replaceWith(t),o=e.content?W(e):e,o[m]=null,r?.hasAttribute(":else")&&(r.removeAttribute(":else"),r.hasAttribute(":if")||(r.remove(),i=r.content?W(r):r,i[m]=null)),c=>{const a=c?o:e[X]?null:i;r&&(r[X]=a===o),s!=a&&(s&&(s.remove(),s[T]?.()),(s=a)&&(t.before(s.content||s),s[m]===null?(delete s[m],A(s,n)):s[C]()))}}),h("each",(e,n,t)=>{const[r,s="$"]=t.split(/\s+in\s+/)[0].split(/\s*,\s*/),o=document.createTextNode("");e.replaceWith(o),e[m]=null;let i,c,a,p=0;const g=()=>{var l,u;let d=0,y=a,b=y.length;if(i&&!i[N]){for(let _ of i[v]||[])_[Symbol.dispose]();i=null,p=0}if(b<p)i.length=b;else{if(!i)i=y;else for(;d<p;)i[d]=y[d++];for(;d<b;d++){i[d]=y[d];let _=d,L=F({[r]:i[v]?.[_]||i[_],[s]:c?c[_]:_},n),k=e.content?W(e):e.cloneNode(!0);o.before(k.content||k),A(k,L),((u=i[l=v]||(i[l]=[]))[d]||(u[d]={}))[Symbol.dispose]=()=>{k[Symbol.dispose]?.(),k.remove()}}}p=b};return l=>{c=null,typeof l=="number"?a=Array.from({length:l},(d,y)=>y+1):l?.constructor===Object?(c=Object.keys(l),a=Object.values(l)):a=l||[];let u=0;return x(()=>{a[N]?.value,u++||(g(),queueMicrotask(()=>(u>1&&g(),u=0)))})}},e=>K(e.split(/\s+in\s+/)[1])),h("default",(e,n,t,r)=>{if(!r.startsWith("on"))return r?l=>j(e,r,l):l=>{for(let u in l)j(e,Z(u),l[u])};const s=r.split("..").map(l=>{let u={evt:"",target:e,test:()=>!0};return u.evt=(l.startsWith("on")?l.slice(2):l).replace(/\.(\w+)?-?([-\w]+)?/g,(d,y,b="")=>(u.test=te[y]?.(u,...b.split("-"))||u.test,"")),u}),o=(l,{evt:u,target:d,test:y,defer:b,stop:_,prevent:L,immediate:k,...I})=>{b&&(l=b(l));const M=S=>{try{y(S)&&(_&&(k?S.stopImmediatePropagation():S.stopPropagation()),L&&S.preventDefault(),l?.call(n,S))}catch(Q){B(Q,`:on${u}`,l)}};return d.addEventListener(u,M,I),()=>d.removeEventListener(u,M,I)};if(s.length==1)return l=>o(l,s[0]);let i,c,a,p=0;const g=l=>{a=o(u=>(a(),c=l?.(u),(p=++p%s.length)?g(c):i&&g(i)),s[p])};return l=>(i=l,!a&&g(i),()=>i=null)});var te={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,n){e.defer=t=>re(t,n?Number(n)||0:108)},debounce(e,n){e.defer=t=>ne(t,n?Number(n)||0:108)},outside:e=>n=>{let t=e.target;return!(t.contains(n.target)||n.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>n=>n.target===e.target,ctrl:(e,...n)=>t=>f.ctrl(t)&&n.every(r=>f[r]?f[r](t):t.key===r),shift:(e,...n)=>t=>f.shift(t)&&n.every(r=>f[r]?f[r](t):t.key===r),alt:(e,...n)=>t=>f.alt(t)&&n.every(r=>f[r]?f[r](t):t.key===r),meta:(e,...n)=>t=>f.meta(t)&&n.every(r=>f[r]?f[r](t):t.key===r),arrow:()=>f.arrow,enter:()=>f.enter,esc:()=>f.esc,tab:()=>f.tab,space:()=>f.space,delete:()=>f.delete,digit:()=>f.digit,letter:()=>f.letter,char:()=>f.char},f={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},re=(e,n)=>{let t,r,s=o=>{t=!0,setTimeout(()=>{if(t=!1,r)return r=!1,s(o),e(o)},n)};return o=>t?r=!0:(s(o),e(o))},ne=(e,n)=>{let t;return r=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(r)},n)}},j=(e,n,t)=>{t==null||t===!1?e.removeAttribute(n):e.setAttribute(n,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},Z=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(n,t)=>(t?"-":"")+n.toLowerCase());h("value",(e,n,t)=>{const r=e.type==="text"||e.type===""?s=>e.setAttribute("value",e.value=s??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(s,o,i)=>(o=e.selectionStart,i=e.selectionEnd,e.setAttribute("value",e.value=s??""),o&&e.setSelectionRange(o,i)):e.type==="checkbox"?s=>(e.checked=s,j(e,"checked",s)):e.type==="select-one"?s=>{for(let o of e.options)o.value==s?o.setAttribute("selected",""):o.removeAttribute("selected");e.value=s}:e.type==="select-multiple"?s=>{for(let o of e.options)o.removeAttribute("selected");for(let o of s)e.querySelector(`[value="${o}"]`).setAttribute("selected","")}:s=>e.value=s;G(n,t);try{const s=z(t),o=e.type==="checkbox"?()=>s(n,e.checked):e.type==="select-multiple"?()=>s(n,[...e.selectedOptions].map(i=>i.value)):()=>s(n,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=o,e.type?.startsWith("select")&&(new MutationObserver(o).observe(e,{childList:!0,subtree:!0,attributes:!0}),A(e,n))}catch{}return r});var z=(e,n=K(`${e}=__`))=>(t,r)=>(t.__=r,n(t,r),delete t.__),G=(e,n,t=n.match(/^\w+(?=\s*(?:\.|\[|$))/))=>{var r;return t&&(e[r=t[0]]??(e[r]=null))};h("ref",(e,n,t,r,s)=>(G(n,t),s(n)==null?(z(t)(n,e),o=>o):o=>o.call(null,e))),h("with",(e,n,t)=>(t=null,r=>A(e,t?r:t=F(r,n)))),h("text",e=>(e.content&&e.replaceWith(e=W(e).childNodes[0]),n=>e.textContent=n??"")),h("class",(e,n)=>(n=new Set,t=>{let r=new Set;t&&(typeof t=="string"?t.split(" ").map(s=>r.add(s)):Array.isArray(t)?t.map(s=>s&&r.add(s)):Object.entries(t).map(([s,o])=>o&&r.add(s)));for(let s of n)r.has(s)?r.delete(s):e.classList.remove(s);for(let s of n=r)e.classList.add(s)})),h("style",(e,n)=>(n=e.getAttribute("style"),t=>{if(typeof t=="string")e.setAttribute("style",n+(n.endsWith(";")?"":"; ")+t);else{n&&e.setAttribute("style",n);for(let r in t)r[0]=="-"?e.style.setProperty(r,t[r]):e.style[r]=t[r]}})),h("fx",e=>n=>n),h("aria",e=>n=>{for(let t in n)j(e,"aria-"+Z(t),n[t]==null?null:n[t]+"")}),h("data",e=>n=>{for(let t in n)e.dataset[t]=n[t]}),A.use({compile:e=>A.constructor(`with (arguments[0]) { return ${e} };`)});var se=A;export{se as default};
