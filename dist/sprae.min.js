var O,k=(e,r,t=new Set)=>(r={get value(){return O?.deps.push(t.add(O)),e},set value(n){if(n!==e){e=n;for(let i of t)i()}},peek(){return e}},r.toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),x=(e,r,t,n)=>(t=i=>{r?.call?.(),i=O,O=t;try{r=e()}finally{O=i}},n=t.deps=[],t(),i=>{for(r?.call?.();i=n.pop();)i.delete(t)}),R=(e,r=k(),t,n)=>(t={get value(){return n||(n=x(()=>r.value=e())),r.value},peek:r.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),T=e=>e(),q=T,Y=e=>(k=e.signal,x=e.effect,R=e.computed,T=e.batch||T,q=e.untracked||q),A=Symbol("signals"),N=Symbol("change"),$=(e,r)=>{if(!e||e[A]||e[Symbol.toStringTag])return e;if(e.constructor!==Object)return Array.isArray(e)?ee(e):e;let t={...r?.[A]},n=k(Object.values(e).length),i=new Proxy(t,{get:(u,a)=>a===N?n:a===A?t:t[a]?.valueOf(),set:(u,a,p,m)=>(m=t[a],C(t,a,p),m??++n.value,1),deleteProperty:(u,a)=>(t[a]&&(t[a][Symbol.dispose]?.(),delete t[a],n.value--),1),ownKeys:()=>(n.value,Reflect.ownKeys(t))}),l=Object.getOwnPropertyDescriptors(e),s;for(let u in e)(s=l[u])?.get?(t[u]=R(s.get.bind(i)))._set=s.set?.bind(i):(t[u]=null,C(t,u,e[u]));return i},ee=e=>{let r,t=k(e.length),n=Array(e.length).fill(),i=new Proxy(n,{get(l,s){if(typeof s=="symbol")return s===N?t:s===A?n:n[s];if(s==="length")return te.includes(r)?t.peek():t.value;if(r=s,n[s])return n[s].valueOf();if(s<n.length)return(n[s]=k($(e[s]))).value},set(l,s,u){if(s==="length"){for(let a=u;a<n.length;a++)delete i[a];t.value=n.length=u}else C(n,s,u),s>=t.peek()&&(t.value=n.length=+s+1);return 1},deleteProperty:(l,s)=>(n[s]?.[Symbol.dispose]?.(),delete n[s],1)});return i},te=["push","pop","shift","unshift","splice"],C=(e,r,t)=>{let n=e[r],i;r[0]==="_"?e[r]=t:n?t===(i=n.peek())||(n._set?n._set(t):Array.isArray(t)&&Array.isArray(i)?i[N]?T(()=>{for(let l=0;l<t.length;l++)i[l]=t[l];i.length=t.length}):n.value=t:n.value=$(t)):e[r]=n=t?.peek?t:k($(t))},F=$,J=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),y=Symbol("state"),D=Symbol("on"),W=Symbol("off"),K={},h=(e,r,t=I)=>K[e]=(n,i,l,s,u,a)=>(a=t(i),u=r(n,l,i,s,a),()=>u(a(l))),V=(e,r)=>{if(e[y])return Object.assign(e[y],r);let t=$(r||{}),n=[],i=[],l=(s,u=s.attributes)=>{if(u)for(let a=0;a<u.length;){let{name:p,value:m}=u[a],o,c,d;if(o=p[0]===":"?1:p[0]==="s"&&p[1]==="-"?2:0){s.removeAttribute(p);for(d of p.slice(o).split(":"))if(c=(K[d]||K.default)(s,m,t,d),i.push(c),n.push(x(c)),s[y]===null)return}else a++}for(let a of s.childNodes)a.nodeType==1&&l(a)};return l(e),y in e||(e[y]=t,e[W]=()=>(n.map(s=>s()),n=[]),e[D]=()=>n=i.map(s=>x(s)),e[J]=()=>(e[W](),e[W]=e[D]=e[J]=e[y]=null)),t};V.use=e=>{e.signal&&Y(e),e.compile&&(X=e.compile)};var I=(e,r,t)=>{if(t=B[e=e.trim()])return t;try{t=X(e)}catch(n){H(n,r,e)}return B[e]=t},B={},H=(e,r="",t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${r}${t?`="${t}"

`:""}`,expr:t})},X,E=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],n=document.createTextNode(""),i=(r.append(n),[...r.childNodes]);return{childNodes:i,content:r,remove:()=>r.append(...i),replaceWith(l){l!==n&&(n.before(l),r.append(...i))},attributes:t,removeAttribute(l){t.splice(t.findIndex(s=>s.name===l),1)}}},S=V,Z=Symbol("if");h("if",(e,r)=>{let t=document.createTextNode(""),n=e.nextElementSibling,i,l,s;return e.replaceWith(t),l=e.content?E(e):e,l[y]=null,n?.hasAttribute(":else")&&(n.removeAttribute(":else"),n.hasAttribute(":if")||(n.remove(),s=n.content?E(n):n,s[y]=null)),(u,a=u?l:e[Z]?null:s)=>{n&&(n[Z]=a===l),i!=a&&(i&&(i.remove(),i[W]?.()),(i=a)&&(t.before(i.content||i),i[y]===null?(delete i[y],S(i,r)):i[D]()))}}),h("each",(e,r,t)=>{let[n,i="$"]=t.split(/\bin\b/)[0].trim().split(/\s*,\s*/),l=document.createTextNode(""),s,u,a,p=0,m=()=>{var o,c;let d=0,b=a,g=b.length;if(s&&!s[N]){for(let _ of s[A]||[])_[Symbol.dispose]();s=null,p=0}if(g<p)s.length=g;else{if(!s)s=b;else for(;d<p;)s[d]=b[d++];for(;d<g;d++){s[d]=b[d];let _=d,L=F({[n]:s[A]?.[_]||s[_],[i]:u?u[_]:_},r),v=e.content?E(e):e.cloneNode(!0);l.before(v.content||v),S(v,L),((c=s[o=A]||(s[o]=[]))[d]||(c[d]={}))[Symbol.dispose]=()=>{v[Symbol.dispose]?.(),v.remove()}}}p=g};return e.replaceWith(l),e[y]=null,o=>{u=null,typeof o=="number"?a=Array.from({length:o},(d,b)=>b+1):o?.constructor===Object?(u=Object.keys(o),a=Object.values(o)):a=o||[];let c=0;return x(()=>{a[N]?.value,c++||(m(),queueMicrotask(()=>(c>1&&m(),c=0)))})}},e=>I(e.split(/\bin\b/)[1])),h("default",(e,r,t,n)=>{if(!n.startsWith("on"))return n?o=>j(e,n,o):o=>{for(let c in o)j(e,z(c),o[c])};let i=n.split("..").map(o=>{let c={evt:"",target:e,test:()=>!0};return c.evt=(o.startsWith("on")?o.slice(2):o).replace(/\.(\w+)?-?([-\w]+)?/g,(d,b,g="")=>(c.test=re[b]?.(c,...g.split("-"))||c.test,"")),c}),l=(o,{evt:c,target:d,test:b,defer:g,stop:_,prevent:L,immediate:v,...M},P)=>(g&&(o=g(o)),P=w=>{try{b(w)&&(_&&(v?w.stopImmediatePropagation():w.stopPropagation()),L&&w.preventDefault(),o?.call(r,w))}catch(U){H(U,`:on${c}`,o)}},d.addEventListener(c,P,M),()=>d.removeEventListener(c,P,M));if(i.length==1)return o=>l(o,i[0]);let s,u,a,p=0,m=o=>{a=l(c=>(a(),u=o?.(c),(p=++p%i.length)?m(u):s&&m(s)),i[p])};return o=>(s=o,!a&&m(s),()=>s=null)});var re={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,r){e.defer=t=>ne(t,r?Number(r)||0:108)},debounce(e,r){e.defer=t=>ie(t,r?Number(r)||0:108)},outside:e=>r=>{let t=e.target;return!(t.contains(r.target)||r.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>r=>r.target===e.target,ctrl:(e,...r)=>t=>f.ctrl(t)&&r.every(n=>f[n]?f[n](t):t.key===n),shift:(e,...r)=>t=>f.shift(t)&&r.every(n=>f[n]?f[n](t):t.key===n),alt:(e,...r)=>t=>f.alt(t)&&r.every(n=>f[n]?f[n](t):t.key===n),meta:(e,...r)=>t=>f.meta(t)&&r.every(n=>f[n]?f[n](t):t.key===n),arrow:()=>f.arrow,enter:()=>f.enter,esc:()=>f.esc,tab:()=>f.tab,space:()=>f.space,delete:()=>f.delete,digit:()=>f.digit,letter:()=>f.letter,char:()=>f.char},f={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},ne=(e,r)=>{let t,n,i=l=>{t=!0,setTimeout(()=>{if(t=!1,n)return n=!1,i(l),e(l)},r)};return l=>t?n=!0:(i(l),e(l))},ie=(e,r)=>{let t;return n=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(n)},r)}},j=(e,r,t)=>{t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},z=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase());h("value",(e,r,t)=>{const n=e.type==="text"||e.type===""?i=>e.setAttribute("value",e.value=i??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(i,l,s)=>(l=e.selectionStart,s=e.selectionEnd,e.setAttribute("value",e.value=i??""),l&&e.setSelectionRange(l,s)):e.type==="checkbox"?i=>(e.checked=i,j(e,"checked",i)):e.type==="select-one"?i=>{for(let l of e.options)l.value==i?l.setAttribute("selected",""):l.removeAttribute("selected");e.value=i}:e.type==="select-multiple"?i=>{for(let l of e.options)l.removeAttribute("selected");for(let l of i)e.querySelector(`[value="${l}"]`).setAttribute("selected","")}:i=>e.value=i;Q(r,t);try{const i=G(t),l=e.type==="checkbox"?()=>i(r,e.checked):e.type==="select-multiple"?()=>i(r,[...e.selectedOptions].map(s=>s.value)):()=>i(r,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=l,e.type?.startsWith("select")&&(new MutationObserver(l).observe(e,{childList:!0,subtree:!0,attributes:!0}),S(e,r))}catch{}return n});var G=(e,r=I(`${e}=__`))=>(t,n)=>(t.__=n,r(t,n),delete t.__),Q=(e,r,t=r.match(/^\w+(?=\s*(?:\.|\[|$))/))=>{var n;return t&&(e[n=t[0]]??(e[n]=null))};h("ref",(e,r,t,n,i)=>(Q(r,t),i(r)==null?(G(t)(r,e),l=>l):l=>l.call(null,e))),h("with",(e,r,t)=>(t=null,n=>S(e,t?n:t=F(n,r)))),h("text",e=>(e.content&&e.replaceWith(e=E(e).childNodes[0]),r=>e.textContent=r??"")),h("class",(e,r)=>(r=new Set,t=>{let n=new Set;t&&(typeof t=="string"?t.split(" ").map(i=>n.add(i)):Array.isArray(t)?t.map(i=>i&&n.add(i)):Object.entries(t).map(([i,l])=>l&&n.add(i)));for(let i of r)n.has(i)?n.delete(i):e.classList.remove(i);for(let i of r=n)e.classList.add(i)})),h("style",(e,r)=>(r=e.getAttribute("style"),t=>{if(typeof t=="string")e.setAttribute("style",r+(r.endsWith(";")?"":"; ")+t);else{r&&e.setAttribute("style",r);for(let n in t)n[0]=="-"?e.style.setProperty(n,t[n]):e.style[n]=t[n]}})),h("fx",e=>r=>r),h("aria",e=>r=>{for(let t in r)j(e,"aria-"+z(t),r[t]==null?null:r[t]+"")}),h("data",e=>r=>{for(let t in r)e.dataset[t]=r[t]}),S.use({compile:e=>S.constructor(`with (arguments[0]) { return ${e} };`)});var se=S;export{se as default};
