var A,N,x=(e,n,t=new Set)=>(n={get value(){return A?.deps.push(t.add(A)),e},set value(r){if(r!==e){e=r;for(let s of t)N?N.add(s):s()}},peek(){return e}},n.toJSON=n.then=n.toString=n.valueOf=()=>n.value,n),T=(e,n,t,r)=>(t=s=>{n?.call?.(),s=A,A=t;try{n=e()}finally{A=s}},r=t.deps=[],t(),s=>{for(n?.call?.();s=r.pop();)s.delete(t)}),D=(e,n=x(),t,r)=>(t={get value(){return r||(r=T(()=>n.value=e())),n.value},peek:n.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),K=e=>{let n=N;n||(N=new Set);try{e()}finally{if(!n){n=N,N=null;for(const t of n)t()}}},I=(e,n,t)=>(n=A,A=null,t=e(),A=n,t);function Q(e){x=e.signal,T=e.effect,D=e.computed,K=e.batch||(n=>n()),I=e.untracked||K}var _=Symbol("signals"),$=Symbol("length");function O(e,n){if(!e||e[_])return e;if(Array.isArray(e))return V(e);if(e.constructor!==Object||e[Symbol.toStringTag])return e;let t={...n?.[_]},r=x(Object.values(e).length);const s=new Proxy(t,{get:(l,i)=>i===$?r:i===_?t:t[i]?.valueOf(),set:(l,i,o,a)=>(a=t[i],M(t,i,o),a??++r.value,1),deleteProperty:(l,i)=>(t[i]&&(F(t,i),r.value--),1),ownKeys(){return r.value,Reflect.ownKeys(t)}});for(let l in e){const i=Object.getOwnPropertyDescriptor(e,l);i?.get?(t[l]=D(i.get.bind(s)))._set=i.set?.bind(s):(t[l]=void 0,M(t,l,e[l]))}return s}var U={push:1,pop:1,shift:1,unshift:1,splice:1};function V(e){let n;if(e[_])return e;let t=x(e.length),r=Array(e.length).fill();const s=new Proxy(r,{get(l,i){if(typeof i=="symbol")return i===$?t:i===_?r:r[i];if(i==="length")return U[n]?t.peek():t.value;if(n=i,r[i])return r[i].valueOf();if(i<r.length)return(r[i]=x(O(e[i]))).value},set(l,i,o){if(i==="length"){for(let a=o,m=r.length;a<m;a++)delete s[a];return t.value=r.length=o,!0}return M(r,i,o),i>=t.peek()&&(t.value=r.length=Number(i)+1),!0},deleteProperty:(l,i)=>(r[i]&&F(r,i),1)});return s}function M(e,n,t){let r=e[n];if(n[0]==="_")e[n]=t;else if(!r)e[n]=r=t?.peek?t:x(O(t));else if(t!==r.peek())if(r._set)r._set(t);else if(Array.isArray(t)&&Array.isArray(r.peek())){const s=r.peek();s[$]?I(()=>{K(()=>{let l=0,i=t.length;for(;l<i;l++)s[l]=t[l];s.length=i})}):r.value=t}else r.value=O(t)}function F(e,n){const t=e[n],r=t[Symbol.dispose];r&&delete t[Symbol.dispose],delete e[n],r?.()}var J=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),h=Symbol("state"),R=Symbol("on"),W=Symbol("off"),p={};function S(e,n){if(!e?.childNodes)return;if(h in e)return Object.assign(e[h],n);const t=O(n||{}),r=[],s=[];return l(e),h in e||(e[h]=t,e[W]=()=>{for(;r.length;)r.pop()()},e[R]=()=>r.push(...s.map(i=>T(i))),e[J]=()=>(e[W](),e[W]=e[R]=e[J]=e[h]=null)),t;function l(i){if(i.childNodes){for(let o=0;o<i.attributes?.length;){let a=i.attributes[o];if(a.name[0]===":"){i.removeAttribute(a.name);for(let m of a.name.slice(1).split(":")){let b=p[m]||p.default,c=b(i,(b.parse||j)(a.value),t,m);if(s.push(c),r.push(T(c)),h in i)return}}else o++}for(let o of[...i.childNodes])l(o)}}}var B={},j=(e,n,t)=>{if(t=B[e=e.trim()])return t;try{t=X(e)}catch(r){H(r,n,e)}return B[e]=t},H=(e,n,t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${n}${t?`="${t}"

`:""}`,expr:t})},X;S.use=e=>{e.signal&&Q(e),e.compile&&(X=e.compile)};var L=e=>{if(!e.nodeType)return e;let n=e.content.cloneNode(!0),t=[...e.attributes],r=document.createTextNode(""),s=(n.append(r),[...n.childNodes]);return{childNodes:s,content:n,remove:()=>n.append(...s),replaceWith(l){l!==r&&(r.before(l),n.append(...s))},attributes:t,removeAttribute(l){t.splice(t.findIndex(i=>i.name===l),1)},setAttributeNode(){}}},Z=Symbol("if");p.if=(e,n,t)=>{let r=e.nextElementSibling,s=document.createTextNode(""),l,i,o;return e.replaceWith(s),i=e.content?L(e):e,i[h]=null,r?.hasAttribute(":else")&&(r.removeAttribute(":else"),r.hasAttribute(":if")||(r.remove(),o=r.content?L(r):r,o[h]=null)),()=>{const a=n(t)?i:e[Z]?null:o;r&&(r[Z]=a===i),l!=a&&(l&&(l.remove(),l[W]?.()),(l=a)&&(s.before(l.content||l),l[h]===null&&delete l[h],l[h]?l[R]():S(l,t)))}},p.each=(e,[n,t,r],s)=>{const l=document.createTextNode("");e.replaceWith(l),e[h]=null;let i,o,a=0;const m=D(()=>{o=null;let u=r(s);return typeof u=="number"&&(u=Array.from({length:u},(k,d)=>d+1)),u?.constructor===Object&&(o=Object.keys(u),u=Object.values(u)),u||[]}),b=()=>{I(()=>{var u,k;let d=0,y=m.value,w=y.length;if(i&&!i[$]){for(let g of i[_]||[])g[Symbol.dispose]();i=null,a=0}if(w<a)i.length=w;else{if(!i)i=y;else for(;d<a;d++)i[d]=y[d];for(;d<w;d++){i[d]=y[d];let g=d,C=O({[n]:i[_]?.[g]||i[g],[t]:o?o[g]:g},s),v=e.content?L(e):e.cloneNode(!0);l.before(v.content||v),S(v,C),((k=i[u=_]||(i[u]=[]))[d]||(k[d]={}))[Symbol.dispose]=()=>{v[Symbol.dispose]?.(),v.remove()}}}a=w})};let c=0;return()=>{m.value[$]?.value,c++||(b(),queueMicrotask(()=>(c>1&&b(),c=0)))}},p.each.parse=e=>{let[n,t]=e.split(/\s+in\s+/),[r,s="$"]=n.split(/\s*,\s*/);return[r,s,j(t)]},p.ref=(e,n,t)=>()=>n(t)?.call?.(null,e),p.with=(e,n,t)=>{let r;return()=>{let s=n(t);S(e,r?s:r=O(s,t))}},p.text=(e,n,t)=>(e.content&&e.replaceWith(e=L(e).childNodes[0]),()=>{let r=n(t);e.textContent=r??""}),p.class=(e,n,t)=>{let r=new Set;return()=>{let s=n(t),l=new Set;s&&(typeof s=="string"?s.split(" ").map(i=>l.add(i)):Array.isArray(s)?s.map(i=>i&&l.add(i)):Object.entries(s).map(([i,o])=>o&&l.add(i)));for(let i of r)l.has(i)?l.delete(i):e.classList.remove(i);for(let i of r=l)e.classList.add(i)}},p.style=(e,n,t)=>{let r=e.getAttribute("style");return()=>{let s=n(t);if(typeof s=="string")e.setAttribute("style",r+(r.endsWith(";")?"":"; ")+s);else{r&&e.setAttribute("style",r);for(let l in s)l[0]=="-"?e.style.setProperty(l,s[l]):e.style[l]=s[l]}}},p.default=(e,n,t,r)=>{if(!r.startsWith("on"))return()=>{let c=n(t);if(r)P(e,r,c);else for(let u in c)P(e,z(u),c[u])};const s=r.split("..").map(c=>{let u={evt:"",target:e,test:()=>!0};return u.evt=(c.startsWith("on")?c.slice(2):c).replace(/\.(\w+)?-?([-\w]+)?/g,(k,d,y="")=>(u.test=Y[d]?.(u,...y.split("-"))||u.test,"")),u});if(s.length==1)return()=>b(n(t),s[0]);let l,i,o,a=0;const m=c=>{o=b(u=>(o(),i=c?.(u),(a=++a%s.length)?m(i):l&&m(l)),s[a])};return()=>(l=n(t),!o&&m(l),()=>l=null);function b(c,{evt:u,target:k,test:d,defer:y,stop:w,prevent:g,immediate:C,...v}){y&&(c=y(c));const q=E=>{try{d(E)&&(w&&(C?E.stopImmediatePropagation():E.stopPropagation()),g&&E.preventDefault(),c?.call(t,E))}catch(G){H(G,`:on${u}`,c)}};return k.addEventListener(u,q,v),()=>k.removeEventListener(u,q,v)}};var Y={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,n){e.defer=t=>ee(t,n?Number(n)||0:108)},debounce(e,n){e.defer=t=>te(t,n?Number(n)||0:108)},outside:e=>n=>{let t=e.target;return!(t.contains(n.target)||n.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>n=>n.target===e.target,ctrl:(e,...n)=>t=>f.ctrl(t)&&n.every(r=>f[r]?f[r](t):t.key===r),shift:(e,...n)=>t=>f.shift(t)&&n.every(r=>f[r]?f[r](t):t.key===r),alt:(e,...n)=>t=>f.alt(t)&&n.every(r=>f[r]?f[r](t):t.key===r),meta:(e,...n)=>t=>f.meta(t)&&n.every(r=>f[r]?f[r](t):t.key===r),arrow:()=>f.arrow,enter:()=>f.enter,esc:()=>f.esc,tab:()=>f.tab,space:()=>f.space,delete:()=>f.delete,digit:()=>f.digit,letter:()=>f.letter,char:()=>f.char},f={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},P=(e,n,t)=>{t==null||t===!1?e.removeAttribute(n):e.setAttribute(n,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},ee=(e,n)=>{let t,r,s=l=>{t=!0,setTimeout(()=>{if(t=!1,r)return r=!1,s(l),e(l)},n)};return l=>t?r=!0:(s(l),e(l))},te=(e,n)=>{let t;return r=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(r)},n)}},z=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(n,t)=>(t?"-":"")+n.toLowerCase());p.value=(e,[n,t],r)=>{const s=e.type==="text"||e.type===""?i=>e.setAttribute("value",e.value=i??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(i,o,a)=>(o=e.selectionStart,a=e.selectionEnd,e.setAttribute("value",e.value=i??""),o&&e.setSelectionRange(o,a)):e.type==="checkbox"?i=>(e.checked=i,P(e,"checked",i)):e.type==="select-one"?i=>{for(let o of e.options)o.value==i?o.setAttribute("selected",""):o.removeAttribute("selected");e.value=i}:e.type==="select-multiple"?i=>{for(let o of e.options)o.removeAttribute("selected");for(let o of i)e.querySelector(`[value="${o}"]`).setAttribute("selected","")}:i=>e.value=i,l=e.type==="checkbox"?()=>t(r,e.checked):e.type==="select-multiple"?()=>t(r,[...e.selectedOptions].map(i=>i.value)):i=>t(r,e.selectedIndex<0?null:e.value);return e.oninput=e.onchange=l,e.type?.startsWith("select")&&(new MutationObserver(l).observe(e,{childList:!0,subtree:!0,attributes:!0}),S(e,r)),()=>{s(n(r))}},p.value.parse=e=>{let n=[j(e)];try{const t=j(`${e}=__`);n.push((r,s)=>{r.__=s,t(r,s),delete r.__})}catch{}return n},p.fx=(e,n,t)=>()=>n(t),p.aria=(e,n,t)=>{const r=s=>{for(let l in s)P(e,"aria-"+z(l),s[l]==null?null:s[l]+"")};return()=>r(n(t))},p.data=(e,n,t)=>()=>{let r=n(t);for(let s in r)e.dataset[s]=r[s]},S.use({compile:e=>S.constructor(`with (arguments[0]) { return ${e} };`)});var re=S;export{re as default};
