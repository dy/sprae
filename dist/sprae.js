var B=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),u=Symbol("state"),H=Symbol("on"),K=Symbol("off"),z=Symbol("add"),N=":",$,I,Q,X=e=>e(),R=X,q={},F={},G=null,ne=(e=document.body,r)=>{if(e[u])return Object.assign(e[u],r);r=J(r||{});let t=[],o=[],n,s=()=>!o&&(o=t.map(a=>a())),i=()=>(o?.map(a=>a()),o=null);e[H]=s,e[K]=i,e[B]||(e[B]=()=>(e[K](),e[K]=e[H]=e[B]=e[u]=e[z]=null));let c=(a,f=a.attributes)=>{if(f)for(let d=0;d<f.length;){let{name:l,value:m}=f[d];if(l.startsWith(N)){if(a.removeAttribute(l),t.push(n=we(a,l,m,r)),o.push(n()),u in a)return}else d++}for(let d of[...a.childNodes])d.nodeType==1&&c(d)};return e[z]=c,c(e),e[u]===void 0&&(e[u]=r),r},we=(e,r,t,o)=>{let n,s,i=r.slice(N.length).split("..").map((c,a,{length:f})=>c.split(N).reduce((d,l)=>{let[m,...h]=l.split("."),C=S(t,q[G=m]?.parse);if(m.startsWith("on")){let P=m.slice(2),re=M=>y(C(o),M),L=oe(Object.assign(f==1?re:M=>(n=(a?n:re)(M),s(),s=i[(a+1)%f]()),{target:e,type:P}),h);return M=>(M=d?.(),L.target.addEventListener(P,L,L),()=>(M?.(),L.target.removeEventListener(P,L)))}let j=(q[m]||q["*"])(e,o,t,m);if(!h.length&&!d)return()=>j&&I(()=>C(o,j));let g,W=$(-1),x=-1,V=w(oe(()=>{++W.value||(g=I(()=>j&&(W.value==x?V():(x=W.value,C(o,j)))))},h));return P=>(P=d?.(),V(),{[m]:()=>(P?.(),g(),W.value=-1,x=g=null)}[m])},null));return()=>s=i[0]()},U=e=>(e.compile&&(ie=e.compile),e.prefix&&(N=e.prefix),e.signal&&($=e.signal),e.effect&&(I=e.effect),e.computed&&(Q=e.computed),e.batch&&(X=e.batch),e.untracked&&(R=e.untracked)),se=(e=document.body,r)=>{let t=J(r);return ne(e,t),new MutationObserver(n=>{for(let s of n)for(let i of s.addedNodes)if(i.nodeType===1&&i[u]===void 0){for(let c of i.attributes)if(c.name.startsWith(N)){e[z](i);break}}}).observe(e,{childList:!0,subtree:!0}),t},ie,S=(e,r,t)=>{if(t=S.cache[e])return t;let o=e.trim()||"undefined";r&&(o=r(o)),/^(if|let|const)\b/.test(o)||/;/.test(o)||(o=`return ${o}`),/\bawait\s/.test(o)&&(o=`return (async()=>{ ${o} })()`);try{t=ie(o),Object.defineProperty(t,"name",{value:`\u2234 ${e}`})}catch(n){console.error(`\u2234 ${n}

${N+G}="${e}"`)}return S.cache[e]=(n,s,i)=>{try{let c=t?.(n);return s?(c?.then?c.then(a=>i=s(a)):i=s(c),()=>y(i)):c}catch(c){console.error(`\u2234 ${c}

${N+G}="${e}"`)}}};S.cache={};var oe=(e,r)=>{for(;r.length;){let[t,...o]=r.pop().split("-");e=Te(F[t]?.(e,...o)??e,e)}return e},Te=(e,r)=>{if(e!=r)for(let t in r)e[t]??(e[t]=r[t]);return e},O=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],o=document.createTextNode(""),n=(r.append(o),[...r.childNodes]);return{childNodes:n,content:r,remove:()=>r.append(...n),replaceWith(s){s!==o&&(o.before(s),r.append(...n))},attributes:t,removeAttribute(s){t.splice(t.findIndex(i=>i.name===s),1)}}},y=(e,r)=>typeof e=="function"?e(r):e,ae=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase()),b=(e,r,t)=>t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":t),Y=(e,r=[])=>e?typeof e=="string"?e:(Array.isArray(e)?e.map(Y):Object.entries(e).reduce((t,[o,n])=>n?[...t,o]:t,[])).join(" "):"",w=(e,r=queueMicrotask)=>{let t=0,o=n=>{t++||(e(n),r((s=t>1)=>(t=0,s&&o(n))))};return o},ce=(e,r=queueMicrotask,t=0)=>(o,n=++t)=>r(()=>n==t&&e(o)),p=ne;var T=Symbol("signals"),A=Symbol("change"),v=Symbol("set"),D=(e,r=globalThis)=>{if(!e||e[Symbol.toStringTag]||e[T])return e;if(e.constructor!==Object)return Array.isArray(e)?Ce(e):e;let t=Object.keys(e).length,o={},n=new Proxy(Object.assign(o,{[A]:$(t),[T]:o}),{get:(i,c)=>c in o?o[c]?o[c].valueOf():o[c]:r[c],set:(i,c,a,f)=>(c in o?le(o,c,a):(Z(o,c,a),o[A].value=++t),1),deleteProperty:(i,c)=>(c in o&&(c[0]!="_"&&o[c]?.[Symbol.dispose]?.(),delete o[c],o[A].value=--t),1),ownKeys:()=>(o[A].value,Reflect.ownKeys(o)),has:i=>1}),s=Object.getOwnPropertyDescriptors(e);for(let i in e)s[i]?.get?(o[i]=Q(s[i].get.bind(n)))[v]=s[i].set?.bind(n):Z(o,i,e[i]);return n};var Ce=(e,r=globalThis)=>{let t=Array(e.length).fill(null),o=!1,n=c=>function(){return o=!0,c.apply(this,arguments)},s=$(e.length),i=new Proxy(Object.assign(t,{[A]:s,[T]:t,push:n(t.push),pop:n(t.pop),shift:n(t.shift),unshift:n(t.unshift),splice:n(t.splice)}),{get(c,a){return a==="length"?o?(o=!1,t.length):s.value:typeof a=="symbol"||isNaN(a)?t[a]?.valueOf()??r[a]:(t[a]??(t[a]=$(D(e[a])))).valueOf()},set(c,a,f){if(a==="length"){for(let d=f;d<t.length;d++)delete i[d];s.value=t.length=f}else a>=t.length?(Z(t,a,f),i.length=+a+1):t[a]?le(t,a,f):Z(t,a,f);return 1},deleteProperty:(c,a)=>(t[a]?.[Symbol.dispose]?.(),delete t[a],1)});return i},Z=(e,r,t)=>e[r]=r[0]=="_"||t?.peek?t:$(D(t)),le=(e,r,t,o,n)=>r[0]==="_"?e[r]=t:t!==(n=(o=e[r]).peek())&&(o[v]?o[v](t):Array.isArray(t)&&Array.isArray(n)?A in n?R(()=>X(()=>{for(let s=0;s<t.length;s++)n[s]=t[s];n.length=t.length})):o.value=t:o.value=D(t)),J=D;var k,ue=0,E,_=(e,r,t=new Set,o=()=>r.value)=>r={get value(){return k?.deps.push(t.add(k)),e},set value(n){if(n!==e){e=n;for(let s of t)E?E.add(s):s()}},peek(){return e},toJSON:o,then:o,toString:o,valueOf:o},ee=(e,r,t,o,n)=>(t=s=>{if(n=r,r=null,n?.call?.(),s=k,k=t,ue++>10)throw"Cycle detected";try{r=e()}finally{k=s,ue--}},o=t.deps=[],t(),s=>{for(r?.call?.();s=o.pop();)s.delete(t)}),fe=(e,r=_(),t,o,n=()=>t.value)=>t={get value(){return o||(o=ee(()=>r.value=e())),r.value},peek:r.peek,toJSON:n,then:n,toString:n,valueOf:n},pe=(e,r=!E)=>{E??(E=new Set);try{e()}finally{if(r){for(let t of E)t();E=null}}},de=(e,r,t)=>(r=k,k=null,t=e(),k=r,t);var me=(e,r,t,o,n)=>{var s;return e._holder?p(o=e,r):(e[s=u]??(e[s]=null),o=e.content?O(e):e,e.replaceWith(t=document.createTextNode("")),o._holder=t._holder=t,t._clauses=[o._clause=[o,!1]],t.update=w(()=>{let i=t._clauses.find(([,c])=>c);i!=n&&(n?.[0].remove(),n?.[0][K]?.(),(n=i)&&(t.before(n[0].content||n[0]),n[0][u]?n[0][H]?.():(delete n[0][u],p(n[0],r))))})),i=>{o._clause[1]=i,o._holder.update()}};var ye=(e,r,t,o,n=e)=>{for(t=e.content?O(e):e;n&&!(t._holder=n._holder);)n=n.previousSibling;return e.remove(),e[u]=null,t._holder._clauses.push(t._clause=[t,!0]),()=>{t._holder.update()}};var he=e=>(e.content&&e.replaceWith(e=O(e).childNodes[0]),r=>(r=y(r,e.textContent),e.textContent=r??""));var be=(e,r,t)=>(r=new Set,o=>{t=new Set,o&&Y(y(o,e.className)).split(" ").map(n=>n&&t.add(n));for(let n of r)t.has(n)?t.delete(n):e.classList.remove(n);for(let n of r=t)e.classList.add(n)});var ge=(e,r)=>(r=e.getAttribute("style"),t=>{if(t=y(t,e.style),typeof t=="string")b(e,"style",r+"; "+t);else{r&&b(e,"style",r);for(let o in t)o[0]=="-"?e.style.setProperty(o,t[o]):o[0]>"A"&&(e.style[o]=t[o])}});var xe=()=>e=>y(e);var We=(e,r=S(`${e}=__`))=>(t,o)=>{t.__=o,r(t),delete t.__},Se=(e,r,t,o)=>{try{let n=We(t),s=e.type==="checkbox"?()=>n(r,e.checked):e.type==="select-multiple"?()=>n(r,[...e.selectedOptions].map(i=>i.value)):()=>n(r,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=s,e.type?.startsWith("select")&&(new MutationObserver(s).observe(e,{childList:!0,subtree:!0,attributes:!0}),p(e,r)),S(t)(r)??s()}catch{}return e.type==="text"||e.type===""?n=>e.setAttribute("value",e.value=n??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(n,s,i)=>(s=e.selectionStart,i=e.selectionEnd,e.setAttribute("value",e.value=n??""),s&&e.setSelectionRange(s,i)):e.type==="checkbox"?n=>(e.checked=n,b(e,"checked",n)):e.type==="radio"?n=>e.value===n&&(e.checked=n,b(e,"checked",n)):e.type==="select-one"?n=>{for(let s of e.options)s.value==n?s.setAttribute("selected",""):s.removeAttribute("selected");e.value=n}:e.type==="select-multiple"?n=>{for(let s of e.options)s.removeAttribute("selected");for(let s of n)e.querySelector(`[value="${s}"]`).setAttribute("selected","")}:n=>e.value=n};var Ae=(e,r,t,o,n,s)=>typeof S(t)(r)=="function"?i=>i(e):(Object.defineProperty(r,t,{value:e,configurable:!0}),()=>{});var Oe=(e,r,t)=>(e[u]=null,t=D({},r),o=>{let n=y(o,t);for(let s in n)t[s]=typeof n[s]=="function"?n[s].bind(t):n[s];return e[u]??(delete e[u],R(()=>p(e,t)))});var ke=(e,r,t)=>{let[o,n="$"]=t.split(/\bin\b/)[0].trim().replace(/\(|\)/g,"").split(/\s*,\s*/),s=document.createTextNode(""),i,c,a,f=0,d=w(()=>{var C,j;let l=0,m=a,h=m.length;if(i&&!i[A]){for(let g of i[T]||[])g[Symbol.dispose]();i=null,f=0}if(h<f)i.length=h;else{if(!i)i=m;else for(;l<f;)i[l]=m[l++];for(;l<h;l++){i[l]=m[l];let g=l,W=Object.create(r,{[o]:{get:()=>i[g]},[n]:{value:c?c[g]:g}}),x=e.content?O(e):e.cloneNode(!0);s.before(x.content||x),p(x,W);let V=((j=i[C=T]||(i[C]=[]))[l]||(j[l]={}))[Symbol.dispose];i[T][l][Symbol.dispose]=()=>{V?.(),x[Symbol.dispose]?.(),x.remove()}}}f=h});return e.replaceWith(s),e[u]=null,l=>(c=null,typeof l=="number"?a=Array.from({length:l},(m,h)=>h+1):l?.constructor===Object?(c=Object.keys(l),a=Object.values(l)):a=l||[],I(()=>{a[A]?.value,d()}))};ke.parse=e=>e.split(/\bin\b/)[1].trim();var je=ke;var Ne=(e,r,t,o)=>n=>b(e,o,y(n,e.getAttribute(o)));var $e=e=>r=>{for(let t in r)b(e,ae(t),r[t])};Object.assign(q,{"*":Ne,"":$e,class:be,text:he,style:ge,fx:xe,value:Se,ref:Ae,scope:Oe,if:me,else:ye,each:je});Object.assign(F,{debounce:(e,r=250,t=r==="tick"?queueMicrotask:r==="raf"?requestAnimationFrame:r==="idle"?requestIdleCallback:n=>setTimeout(n,r),o=0)=>ce(e,t),throttle:(e,r=250,t=r==="tick"?queueMicrotask:r==="raf"?requestAnimationFrame:o=>setTimeout(o,r))=>w(e,t),once:(e,r,t)=>Object.assign(o=>!r&&(r=1,e(o)),{once:!0}),prevent:e=>r=>(r?.preventDefault(),e(r)),stop:e=>r=>(r?.stopPropagation(),e(r)),immediate:e=>r=>(r?.stopImmediatePropagation(),e(r)),passive:e=>(e.passive=!0,e),capture:e=>(e.capture=!0,e),window:e=>(e.target=window,e),document:e=>(e.target=document,e),parent:e=>(e.target=e.target.parentNode,e),self:e=>r=>r.target===e.target&&e(r),outside:e=>(r,t)=>(t=e.target,!t.contains(r.target)&&r.target.isConnected&&(t.offsetWidth||t.offsetHeight))});var te={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)};for(let e in te)F[e]=(r,...t)=>o=>te[e](o)&&t.every(n=>te[n]?.(o)??o.key===n)&&r(o);U({compile:e=>p.constructor(`with (arguments[0]) { ${e} }`),signal:_,effect:ee,computed:fe,batch:pe,untracked:de});p.use=U;p.store=J;p.directive=q;p.modifier=F;p.start=se;var qt=p;export{pe as batch,fe as computed,qt as default,ee as effect,_ as signal,p as sprae,se as start,J as store,de as untracked,U as use};
