(function(T,g){typeof exports=="object"&&typeof module=="object"?module.exports=g():typeof define=="function"&&define.amd?define("sprae",[],g):typeof exports=="object"?exports.sprae=g():T.sprae=g()})(typeof self<"u"?self:typeof globalThis<"u"?globalThis:void 0,()=>{var T={},g={exports:T},J=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,ee=Object.getOwnPropertyNames,be=Object.prototype.hasOwnProperty,d=(e,r)=>function(){return e&&(r=(0,e[ee(e)[0]])(e=0)),r},he=(e,r)=>{for(var t in r)J(e,t,{get:r[t],enumerable:!0})},me=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of ee(r))!be.call(e,n)&&n!==t&&J(e,n,{get:()=>r[n],enumerable:!(i=ye(r,n))||i.enumerable});return e},ge=e=>me(J({},"__esModule",{value:!0}),e);function _e(e){S=e.signal,x=e.effect,R=e.computed,N=e.batch||N,te=e.untracked||N}var $,S,x,R,N,te,q=d({"signal.js"(){S=(e,r,t=new Set)=>(r={get value(){return $?.deps.push(t.add($)),e},set value(i){if(i!==e){e=i;for(let n of t)n()}},peek(){return e}},r.toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),x=(e,r,t,i)=>(t=n=>{r?.call?.(),n=$,$=t;try{r=e()}finally{$=n}},i=t.deps=[],t(),n=>{for(r?.call?.();n=i.pop();)n.delete(t)}),R=(e,r=S(),t,i)=>(t={get value(){return i||(i=x(()=>r.value=e())),r.value},peek:r.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),N=e=>e(),te=N}});function P(e,r){if(!e||e[v])return e;if(Array.isArray(e))return ve(e);if(e.constructor!==Object||e[Symbol.toStringTag])return e;let t={...r?.[v]},i=S(Object.values(e).length);const n=new Proxy(t,{get:(s,o)=>o===E?i:o===v?t:t[o]?.valueOf(),set:(s,o,c,a)=>(a=t[o],F(t,o,c),a??++i.value,1),deleteProperty:(s,o)=>(t[o]&&(re(t,o),i.value--),1),ownKeys(){return i.value,Reflect.ownKeys(t)}});for(let s in e){const o=Object.getOwnPropertyDescriptor(e,s);o?.get?(t[s]=R(o.get.bind(n)))._set=o.set?.bind(n):(t[s]=void 0,F(t,s,e[s]))}return n}function ve(e){let r;if(e[v])return e;let t=S(e.length),i=Array(e.length).fill();const n=new Proxy(i,{get(s,o){if(typeof o=="symbol")return o===E?t:o===v?i:i[o];if(o==="length")return ie[r]?t.peek():t.value;if(r=o,i[o])return i[o].valueOf();if(o<i.length)return(i[o]=S(P(e[o]))).value},set(s,o,c){if(o==="length"){for(let a=c,b=i.length;a<b;a++)delete n[a];return t.value=i.length=c,!0}return F(i,o,c),o>=t.peek()&&(t.value=i.length=Number(o)+1),!0},deleteProperty:(s,o)=>(i[o]&&re(i,o),1)});return n}function F(e,r,t){let i=e[r];if(r[0]==="_")e[r]=t;else if(!i)e[r]=i=t?.peek?t:S(P(t));else if(t!==i.peek())if(i._set)i._set(t);else if(Array.isArray(t)&&Array.isArray(i.peek())){const n=i.peek();n[E]?N(()=>{let s=0,o=t.length;for(;s<o;s++)n[s]=t[s];n.length=o}):i.value=t}else i.value=P(t)}function re(e,r){const t=e[r],i=t[Symbol.dispose];i&&delete t[Symbol.dispose],delete e[r],i?.()}var v,E,ie,V=d({"store.js"(){q(),v=Symbol("signals"),E=Symbol("change"),ie={push:1,pop:1,shift:1,unshift:1,splice:1}}});function O(e,r){if(!e?.childNodes)return;if(h in e)return Object.assign(e[h],r);const t=P(r||{}),i=[],n=[];return s(e),h in e||(e[h]=t,e[L]=()=>{for(;i.length;)i.pop()()},e[K]=()=>i.push(...n.map(o=>x(o))),e[B]=()=>(e[L](),e[L]=e[K]=e[B]=e[h]=null)),t;function s(o){if(o.childNodes){for(let c=0;c<o.attributes?.length;){let a=o.attributes[c],b;if(a.name[0]===":"){o.removeAttribute(a.name);for(let j of a.name.slice(1).split(":"))if(b=(I[j]||I.default)(o,a.value,t,j),n.push(b),i.push(x(b)),h in o)return}else c++}for(let c of[...o.childNodes])s(c)}}}var B,h,K,L,I,m,H,M,X,ne,W,y=d({"core.js"(){q(),V(),B=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),h=Symbol("state"),K=Symbol("on"),L=Symbol("off"),I={},m=(e,r,t=M)=>I[e]=(i,n,s,o,c,a)=>(a=t(n),c=r(i,s,n,o,a),()=>c(a(s))),H={},M=(e,r)=>{let t;if(t=H[e=e.trim()])return t;try{t=ne(e)}catch(i){X(i,r,e)}return H[e]=t},X=(e,r,t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${r||""}${t?`="${t}"

`:""}`,expr:t})},O.use=e=>{e.signal&&_e(e),e.compile&&(ne=e.compile)},W=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],i=document.createTextNode(""),n=(r.append(i),[...r.childNodes]);return{childNodes:n,content:r,remove:()=>r.append(...n),replaceWith(s){s!==i&&(i.before(s),r.append(...n))},attributes:t,removeAttribute(s){t.splice(t.findIndex(o=>o.name===s),1)},setAttributeNode(){}}}}}),Z,je=d({"directive/if.js"(){y(),Z=Symbol("if"),m("if",(e,r)=>{const t=document.createTextNode("");let i=e.nextElementSibling,n,s,o;return e.replaceWith(t),s=e.content?W(e):e,s[h]=null,i?.hasAttribute(":else")&&(i.removeAttribute(":else"),i.hasAttribute(":if")||(i.remove(),o=i.content?W(i):i,o[h]=null)),c=>{const a=c?s:e[Z]?null:o;i&&(i[Z]=a===s),n!=a&&(n&&(n.remove(),n[L]?.()),(n=a)&&(t.before(n.content||n),n[h]===null&&delete n[h],n[h]?n[K]():O(n,r)))}})}}),we=d({"directive/each.js"(){y(),V(),q(),m("each",(e,r,t)=>{const[i,n="$"]=t.split(/\s+in\s+/)[0].split(/\s*,\s*/),s=document.createTextNode("");e.replaceWith(s),e[h]=null;let o,c,a,b=0;const j=()=>{var l,f;let p=0,_=a,w=_.length;if(o&&!o[E]){for(let A of o[v]||[])A[Symbol.dispose]();o=null,b=0}if(w<b)o.length=w;else{if(!o)o=_;else for(;p<b;)o[p]=_[p++];for(;p<w;p++){o[p]=_[p];let A=p,Y=P({[i]:o[v]?.[A]||o[A],[n]:c?c[A]:A},r),k=e.content?W(e):e.cloneNode(!0);s.before(k.content||k),O(k,Y),((f=o[l=v]||(o[l]=[]))[p]||(f[p]={}))[Symbol.dispose]=()=>{k[Symbol.dispose]?.(),k.remove()}}}b=w};return l=>{c=null,typeof l=="number"?a=Array.from({length:l},(p,_)=>_+1):l?.constructor===Object?(c=Object.keys(l),a=Object.values(l)):a=l||[];let f=0;return x(()=>{a[E]?.value,f++||(j(),queueMicrotask(()=>(f>1&&j(),f=0)))})}},e=>M(e.split(/\s+in\s+/)[1]))}}),oe,u,se,ae,C,z,G=d({"directive/default.js"(){y(),m("default",(e,r,t,i)=>{if(!i.startsWith("on"))return i?l=>C(e,i,l):l=>{for(let f in l)C(e,z(f),l[f])};const n=i.split("..").map(l=>{let f={evt:"",target:e,test:()=>!0};return f.evt=(l.startsWith("on")?l.slice(2):l).replace(/\.(\w+)?-?([-\w]+)?/g,(p,_,w="")=>(f.test=oe[_]?.(f,...w.split("-"))||f.test,"")),f}),s=(l,{evt:f,target:p,test:_,defer:w,stop:A,prevent:Y,immediate:k,...de})=>{w&&(l=w(l));const pe=D=>{try{_(D)&&(A&&(k?D.stopImmediatePropagation():D.stopPropagation()),Y&&D.preventDefault(),l?.call(r,D))}catch(Le){X(Le,`:on${f}`,l)}};return p.addEventListener(f,pe,de),()=>p.removeEventListener(f,pe,de)};if(n.length==1)return l=>s(l,n[0]);let o,c,a,b=0;const j=l=>{a=s(f=>(a(),c=l?.(f),(b=++b%n.length)?j(c):o&&j(o)),n[b])};return l=>(o=l,!a&&j(o),()=>o=null)}),oe={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,r){e.defer=t=>se(t,r?Number(r)||0:108)},debounce(e,r){e.defer=t=>ae(t,r?Number(r)||0:108)},outside:e=>r=>{let t=e.target;return!(t.contains(r.target)||r.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>r=>r.target===e.target,ctrl:(e,...r)=>t=>u.ctrl(t)&&r.every(i=>u[i]?u[i](t):t.key===i),shift:(e,...r)=>t=>u.shift(t)&&r.every(i=>u[i]?u[i](t):t.key===i),alt:(e,...r)=>t=>u.alt(t)&&r.every(i=>u[i]?u[i](t):t.key===i),meta:(e,...r)=>t=>u.meta(t)&&r.every(i=>u[i]?u[i](t):t.key===i),arrow:()=>u.arrow,enter:()=>u.enter,esc:()=>u.esc,tab:()=>u.tab,space:()=>u.space,delete:()=>u.delete,digit:()=>u.digit,letter:()=>u.letter,char:()=>u.char},u={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},se=(e,r)=>{let t,i,n=s=>{t=!0,setTimeout(()=>{if(t=!1,i)return i=!1,n(s),e(s)},r)};return s=>t?i=!0:(n(s),e(s))},ae=(e,r)=>{let t;return i=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(i)},r)}},C=(e,r,t)=>{t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},z=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase())}}),Q,U,le=d({"directive/value.js"(){y(),y(),G(),m("value",(e,r,t)=>{const i=e.type==="text"||e.type===""?n=>e.setAttribute("value",e.value=n??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(n,s,o)=>(s=e.selectionStart,o=e.selectionEnd,e.setAttribute("value",e.value=n??""),s&&e.setSelectionRange(s,o)):e.type==="checkbox"?n=>(e.checked=n,C(e,"checked",n)):e.type==="select-one"?n=>{for(let s of e.options)s.value==n?s.setAttribute("selected",""):s.removeAttribute("selected");e.value=n}:e.type==="select-multiple"?n=>{for(let s of e.options)s.removeAttribute("selected");for(let s of n)e.querySelector(`[value="${s}"]`).setAttribute("selected","")}:n=>e.value=n;U(r,t);try{const n=Q(t),s=e.type==="checkbox"?()=>n(r,e.checked):e.type==="select-multiple"?()=>n(r,[...e.selectedOptions].map(o=>o.value)):()=>n(r,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=s,e.type?.startsWith("select")&&(new MutationObserver(s).observe(e,{childList:!0,subtree:!0,attributes:!0}),O(e,r))}catch{}return i}),Q=(e,r=M(`${e}=__`))=>(t,i)=>(t.__=i,r(t,i),delete t.__),U=(e,r,t=r.match(/^\w+(?=\s*(?:\.|\[|$))/))=>{var i;return t&&(e[i=t[0]]||(e[i]=null))}}}),Oe=d({"directive/ref.js"(){y(),le(),m("ref",(e,r,t,i,n)=>(U(r,t),n(r)==null?(Q(t)(r,e),s=>s):s=>s.call(null,e)))}}),Ae=d({"directive/with.js"(){y(),V(),m("with",(e,r,t)=>(t=null,i=>O(e,t?i:t=P(i,r))))}}),Se=d({"directive/text.js"(){y(),m("text",e=>(e.content&&e.replaceWith(e=W(e).childNodes[0]),r=>e.textContent=r??""))}}),ke=d({"directive/class.js"(){y(),m("class",(e,r)=>(r=new Set,t=>{let i=new Set;t&&(typeof t=="string"?t.split(" ").map(n=>i.add(n)):Array.isArray(t)?t.map(n=>n&&i.add(n)):Object.entries(t).map(([n,s])=>s&&i.add(n)));for(let n of r)i.has(n)?i.delete(n):e.classList.remove(n);for(let n of r=i)e.classList.add(n)}))}}),xe=d({"directive/style.js"(){y(),m("style",(e,r)=>(r=e.getAttribute("style"),t=>{if(typeof t=="string")e.setAttribute("style",r+(r.endsWith(";")?"":"; ")+t);else{r&&e.setAttribute("style",r);for(let i in t)i[0]=="-"?e.style.setProperty(i,t[i]):e.style[i]=t[i]}}))}}),Ne=d({"directive/fx.js"(){y(),m("fx",e=>r=>r)}}),Pe=d({"directive/aria.js"(){y(),G(),m("aria",e=>r=>{for(let t in r)C(e,"aria-"+z(t),r[t]==null?null:r[t]+"")})}}),Ee=d({"directive/data.js"(){y(),m("data",e=>r=>{for(let t in r)e.dataset[t]=r[t]})}}),ce={};he(ce,{default:()=>ue});var ue,Te=d({"sprae.js"(){y(),je(),we(),Oe(),Ae(),Se(),ke(),xe(),le(),Ne(),G(),Pe(),Ee(),O.use({compile:e=>O.constructor(`with (arguments[0]) { return ${e} };`)}),ue=O}}),{default:fe}=(Te(),ge(ce));if(g.exports=fe,document.currentScript?.hasAttribute("init")){const e=JSON.parse(document.currentScript?.getAttribute("init")||"{}"),r=()=>{fe(document.documentElement,e)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r()}if(typeof g.exports=="object"&&typeof T=="object"){var $e=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Object.getOwnPropertyNames(r))!Object.prototype.hasOwnProperty.call(e,n)&&n!==t&&Object.defineProperty(e,n,{get:()=>r[n],enumerable:!(i=Object.getOwnPropertyDescriptor(r,n))||i.enumerable});return e};g.exports=$e(g.exports,T)}return g.exports});
