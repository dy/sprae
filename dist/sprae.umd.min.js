(function(T,m){typeof exports=="object"&&typeof module=="object"?module.exports=m():typeof define=="function"&&define.amd?define("sprae",[],m):typeof exports=="object"?exports.sprae=m():T.sprae=m()})(typeof self<"u"?self:typeof globalThis<"u"?globalThis:void 0,()=>{var T={},m={exports:T},J=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,ee=Object.getOwnPropertyNames,ye=Object.prototype.hasOwnProperty,d=(e,r)=>function(){return e&&(r=(0,e[ee(e)[0]])(e=0)),r},he=(e,r)=>{for(var t in r)J(e,t,{get:r[t],enumerable:!0})},be=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of ee(r))!ye.call(e,n)&&n!==t&&J(e,n,{get:()=>r[n],enumerable:!(i=pe(r,n))||i.enumerable});return e},me=e=>be(J({},"__esModule",{value:!0}),e);function ge(e){S=e.signal,k=e.effect,R=e.computed,P=e.batch||P,te=e.untracked||P}var $,S,k,R,P,te,q=d({"signal.js"(){S=(e,r,t=new Set)=>(r={get value(){return $?.deps.push(t.add($)),e},set value(i){if(i!==e){e=i;for(let n of t)n()}},peek(){return e}},r.toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),k=(e,r,t,i)=>(t=n=>{r?.call?.(),n=$,$=t;try{r=e()}finally{$=n}},i=t.deps=[],t(),n=>{for(r?.call?.();n=i.pop();)n.delete(t)}),R=(e,r=S(),t,i)=>(t={get value(){return i||(i=k(()=>r.value=e())),r.value},peek:r.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),P=e=>e(),te=P}});function N(e,r){if(!e||e[j])return e;if(Array.isArray(e))return _e(e);if(e.constructor!==Object||e[Symbol.toStringTag])return e;let t={...r?.[j]},i=S(Object.values(e).length);const n=new Proxy(t,{get:(o,s)=>s===E?i:s===j?t:t[s]?.valueOf(),set:(o,s,c,l)=>(l=t[s],F(t,s,c),l??++i.value,1),deleteProperty:(o,s)=>(t[s]&&(t[s][Symbol.dispose]?.(),delete t[s],i.value--),1),ownKeys:()=>(i.value,Reflect.ownKeys(t))});for(let o in e){const s=Object.getOwnPropertyDescriptor(e,o);s?.get?(t[o]=R(s.get.bind(n)))._set=s.set?.bind(n):(t[o]=null,F(t,o,e[o]))}return n}function _e(e){let r;if(e[j])return e;let t=S(e.length),i=Array(e.length).fill();const n=new Proxy(i,{get(o,s){if(typeof s=="symbol")return s===E?t:s===j?i:i[s];if(s==="length")return re.includes(r)?t.peek():t.value;if(r=s,i[s])return i[s].valueOf();if(s<i.length)return(i[s]=S(N(e[s]))).value},set(o,s,c){if(s==="length"){for(let l=c;l<i.length;l++)delete n[l];return t.value=i.length=c,!0}return F(i,s,c),s>=t.peek()&&(t.value=i.length=+s+1),!0},deleteProperty:(o,s)=>(i[s]?.[Symbol.dispose]?.(),delete i[s],1)});return n}function F(e,r,t){let i=e[r];if(r[0]==="_")e[r]=t;else if(!i)e[r]=i=t?.peek?t:S(N(t));else if(t!==i.peek())if(i._set)i._set(t);else if(Array.isArray(t)&&Array.isArray(i.peek())){const n=i.peek();n[E]?P(()=>{for(let o=0;o<t.length;o++)n[o]=t[o];n.length=t.length}):i.value=t}else i.value=N(t)}var j,E,re,V=d({"store.js"(){q(),j=Symbol("signals"),E=Symbol("change"),re=["push","pop","shift","unshift","splice"]}});function O(e,r){if(!e?.childNodes)return;if(e[b])return Object.assign(e[b],r);const t=N(r||{}),i=[],n=[],o=s=>{if(s.childNodes){for(let c=0;c<s.attributes?.length;){let{name:l,value:g}=s.attributes[c],_,a=l[0]===":"?1:l[0]==="s"&&l[1]==="-"?2:0;if(a){s.removeAttribute(l);for(let u of l.slice(a).split(":"))if(_=(I[u]||I.default)(s,g,t,u),n.push(_),i.push(k(_)),s[b]===null)return}else c++}for(let c of[...s.childNodes])o(c)}};return o(e),b in e||(e[b]=t,e[L]=()=>{for(;i.length;)i.pop()()},e[K]=()=>i.push(...n.map(s=>k(s))),e[B]=()=>(e[L](),e[L]=e[K]=e[B]=e[b]=null)),t}var B,b,K,L,I,h,M,H,X,ie,W,y=d({"core.js"(){q(),V(),B=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),b=Symbol("state"),K=Symbol("on"),L=Symbol("off"),I={},h=(e,r,t=M)=>I[e]=(i,n,o,s,c,l)=>(l=t(n),c=r(i,o,n,s,l),()=>c(l(o))),M=(e,r,t)=>{if(t=H[e=e.trim()])return t;try{t=ie(e)}catch(i){X(i,r,e)}return H[e]=t},H={},X=(e,r="",t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${r}${t?`="${t}"

`:""}`,expr:t})},O.use=e=>{e.signal&&ge(e),e.compile&&(ie=e.compile)},W=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],i=document.createTextNode(""),n=(r.append(i),[...r.childNodes]);return{childNodes:n,content:r,remove:()=>r.append(...n),replaceWith(o){o!==i&&(i.before(o),r.append(...n))},attributes:t,removeAttribute(o){t.splice(t.findIndex(s=>s.name===o),1)}}}}}),Z,ve=d({"directive/if.js"(){y(),Z=Symbol("if"),h("if",(e,r)=>{const t=document.createTextNode("");let i=e.nextElementSibling,n,o,s;return e.replaceWith(t),o=e.content?W(e):e,o[b]=null,i?.hasAttribute(":else")&&(i.removeAttribute(":else"),i.hasAttribute(":if")||(i.remove(),s=i.content?W(i):i,s[b]=null)),c=>{const l=c?o:e[Z]?null:s;i&&(i[Z]=l===o),n!=l&&(n&&(n.remove(),n[L]?.()),(n=l)&&(t.before(n.content||n),n[b]===null?(delete n[b],O(n,r)):n[K]()))}})}}),je=d({"directive/each.js"(){y(),V(),q(),h("each",(e,r,t)=>{const[i,n="$"]=t.split(/\s+in\s+/)[0].split(/\s*,\s*/),o=document.createTextNode("");e.replaceWith(o),e[b]=null;let s,c,l,g=0;const _=()=>{var a,u;let p=0,v=l,w=v.length;if(s&&!s[E]){for(let A of s[j]||[])A[Symbol.dispose]();s=null,g=0}if(w<g)s.length=w;else{if(!s)s=v;else for(;p<g;)s[p]=v[p++];for(;p<w;p++){s[p]=v[p];let A=p,Y=N({[i]:s[j]?.[A]||s[A],[n]:c?c[A]:A},r),x=e.content?W(e):e.cloneNode(!0);o.before(x.content||x),O(x,Y),((u=s[a=j]||(s[a]=[]))[p]||(u[p]={}))[Symbol.dispose]=()=>{x[Symbol.dispose]?.(),x.remove()}}}g=w};return a=>{c=null,typeof a=="number"?l=Array.from({length:a},(p,v)=>v+1):a?.constructor===Object?(c=Object.keys(a),l=Object.values(a)):l=a||[];let u=0;return k(()=>{l[E]?.value,u++||(_(),queueMicrotask(()=>(u>1&&_(),u=0)))})}},e=>M(e.split(/\s+in\s+/)[1]))}}),ne,f,se,oe,C,z,G=d({"directive/default.js"(){y(),h("default",(e,r,t,i)=>{if(!i.startsWith("on"))return i?a=>C(e,i,a):a=>{for(let u in a)C(e,z(u),a[u])};const n=i.split("..").map(a=>{let u={evt:"",target:e,test:()=>!0};return u.evt=(a.startsWith("on")?a.slice(2):a).replace(/\.(\w+)?-?([-\w]+)?/g,(p,v,w="")=>(u.test=ne[v]?.(u,...w.split("-"))||u.test,"")),u}),o=(a,{evt:u,target:p,test:v,defer:w,stop:A,prevent:Y,immediate:x,...fe})=>{w&&(a=w(a));const de=D=>{try{v(D)&&(A&&(x?D.stopImmediatePropagation():D.stopPropagation()),Y&&D.preventDefault(),a?.call(r,D))}catch($e){X($e,`:on${u}`,a)}};return p.addEventListener(u,de,fe),()=>p.removeEventListener(u,de,fe)};if(n.length==1)return a=>o(a,n[0]);let s,c,l,g=0;const _=a=>{l=o(u=>(l(),c=a?.(u),(g=++g%n.length)?_(c):s&&_(s)),n[g])};return a=>(s=a,!l&&_(s),()=>s=null)}),ne={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,r){e.defer=t=>se(t,r?Number(r)||0:108)},debounce(e,r){e.defer=t=>oe(t,r?Number(r)||0:108)},outside:e=>r=>{let t=e.target;return!(t.contains(r.target)||r.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>r=>r.target===e.target,ctrl:(e,...r)=>t=>f.ctrl(t)&&r.every(i=>f[i]?f[i](t):t.key===i),shift:(e,...r)=>t=>f.shift(t)&&r.every(i=>f[i]?f[i](t):t.key===i),alt:(e,...r)=>t=>f.alt(t)&&r.every(i=>f[i]?f[i](t):t.key===i),meta:(e,...r)=>t=>f.meta(t)&&r.every(i=>f[i]?f[i](t):t.key===i),arrow:()=>f.arrow,enter:()=>f.enter,esc:()=>f.esc,tab:()=>f.tab,space:()=>f.space,delete:()=>f.delete,digit:()=>f.digit,letter:()=>f.letter,char:()=>f.char},f={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},se=(e,r)=>{let t,i,n=o=>{t=!0,setTimeout(()=>{if(t=!1,i)return i=!1,n(o),e(o)},r)};return o=>t?i=!0:(n(o),e(o))},oe=(e,r)=>{let t;return i=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(i)},r)}},C=(e,r,t)=>{t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},z=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase())}}),Q,U,ae=d({"directive/value.js"(){y(),y(),G(),h("value",(e,r,t)=>{const i=e.type==="text"||e.type===""?n=>e.setAttribute("value",e.value=n??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(n,o,s)=>(o=e.selectionStart,s=e.selectionEnd,e.setAttribute("value",e.value=n??""),o&&e.setSelectionRange(o,s)):e.type==="checkbox"?n=>(e.checked=n,C(e,"checked",n)):e.type==="select-one"?n=>{for(let o of e.options)o.value==n?o.setAttribute("selected",""):o.removeAttribute("selected");e.value=n}:e.type==="select-multiple"?n=>{for(let o of e.options)o.removeAttribute("selected");for(let o of n)e.querySelector(`[value="${o}"]`).setAttribute("selected","")}:n=>e.value=n;U(r,t);try{const n=Q(t),o=e.type==="checkbox"?()=>n(r,e.checked):e.type==="select-multiple"?()=>n(r,[...e.selectedOptions].map(s=>s.value)):()=>n(r,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=o,e.type?.startsWith("select")&&(new MutationObserver(o).observe(e,{childList:!0,subtree:!0,attributes:!0}),O(e,r))}catch{}return i}),Q=(e,r=M(`${e}=__`))=>(t,i)=>(t.__=i,r(t,i),delete t.__),U=(e,r,t=r.match(/^\w+(?=\s*(?:\.|\[|$))/))=>{var i;return t&&(e[i=t[0]]??(e[i]=null))}}}),we=d({"directive/ref.js"(){y(),ae(),h("ref",(e,r,t,i,n)=>(U(r,t),n(r)==null?(Q(t)(r,e),o=>o):o=>o.call(null,e)))}}),Oe=d({"directive/with.js"(){y(),V(),h("with",(e,r,t)=>(t=null,i=>O(e,t?i:t=N(i,r))))}}),Ae=d({"directive/text.js"(){y(),h("text",e=>(e.content&&e.replaceWith(e=W(e).childNodes[0]),r=>e.textContent=r??""))}}),Se=d({"directive/class.js"(){y(),h("class",(e,r)=>(r=new Set,t=>{let i=new Set;t&&(typeof t=="string"?t.split(" ").map(n=>i.add(n)):Array.isArray(t)?t.map(n=>n&&i.add(n)):Object.entries(t).map(([n,o])=>o&&i.add(n)));for(let n of r)i.has(n)?i.delete(n):e.classList.remove(n);for(let n of r=i)e.classList.add(n)}))}}),xe=d({"directive/style.js"(){y(),h("style",(e,r)=>(r=e.getAttribute("style"),t=>{if(typeof t=="string")e.setAttribute("style",r+(r.endsWith(";")?"":"; ")+t);else{r&&e.setAttribute("style",r);for(let i in t)i[0]=="-"?e.style.setProperty(i,t[i]):e.style[i]=t[i]}}))}}),ke=d({"directive/fx.js"(){y(),h("fx",e=>r=>r)}}),Pe=d({"directive/aria.js"(){y(),G(),h("aria",e=>r=>{for(let t in r)C(e,"aria-"+z(t),r[t]==null?null:r[t]+"")})}}),Ne=d({"directive/data.js"(){y(),h("data",e=>r=>{for(let t in r)e.dataset[t]=r[t]})}}),le={};he(le,{default:()=>ce});var ce,Ee=d({"sprae.js"(){y(),ve(),je(),we(),Oe(),Ae(),Se(),xe(),ae(),ke(),G(),Pe(),Ne(),O.use({compile:e=>O.constructor(`with (arguments[0]) { return ${e} };`)}),ce=O}}),{default:ue}=(Ee(),me(le));if(m.exports=ue,document.currentScript?.hasAttribute("init")){const e=JSON.parse(document.currentScript?.getAttribute("init")||"{}"),r=()=>{ue(document.documentElement,e)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r()}if(typeof m.exports=="object"&&typeof T=="object"){var Te=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Object.getOwnPropertyNames(r))!Object.prototype.hasOwnProperty.call(e,n)&&n!==t&&Object.defineProperty(e,n,{get:()=>r[n],enumerable:!(i=Object.getOwnPropertyDescriptor(r,n))||i.enumerable});return e};m.exports=Te(m.exports,T)}return m.exports});
