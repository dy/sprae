(function($,g){typeof exports=="object"&&typeof module=="object"?module.exports=g():typeof define=="function"&&define.amd?define("sprae",[],g):typeof exports=="object"?exports.sprae=g():$.sprae=g()})(typeof self<"u"?self:typeof globalThis<"u"?globalThis:void 0,()=>{var $={},g={exports:$},F=Object.defineProperty,fe=Object.getOwnPropertyDescriptor,ee=Object.getOwnPropertyNames,de=Object.prototype.hasOwnProperty,y=(e,r)=>function(){return e&&(r=(0,e[ee(e)[0]])(e=0)),r},pe=(e,r)=>{for(var t in r)F(e,t,{get:r[t],enumerable:!0})},ye=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ee(r))!de.call(e,o)&&o!==t&&F(e,o,{get:()=>r[o],enumerable:!(i=fe(r,o))||i.enumerable});return e},be=e=>ye(F({},"__esModule",{value:!0}),e);function he(e){x=e.signal,L=e.effect,M=e.computed,J=e.batch||(r=>r()),R=e.untracked||J}var j,N,x,L,M,J,R,B=y({"signal.js"(){x=(e,r,t=new Set)=>(r={get value(){return j?.deps.push(t.add(j)),e},set value(i){if(i!==e){e=i;for(let o of t)N?N.add(o):o()}},peek(){return e}},r.toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),L=(e,r,t,i)=>(t=o=>{r?.call?.(),o=j,j=t;try{r=e()}finally{j=o}},i=t.deps=[],t(),o=>{for(r?.call?.();o=i.pop();)o.delete(t)}),M=(e,r=x(),t,i)=>(t={get value(){return i||(i=L(()=>r.value=e())),r.value},peek:r.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),J=e=>{let r=N;r||(N=new Set);try{e()}finally{if(!r){r=N,N=null;for(const t of r)t()}}},R=(e,r,t)=>(r=j,j=null,t=e(),j=r,t)}});function P(e,r){if(!e||e[v])return e;if(Array.isArray(e))return me(e);if(e.constructor!==Object||e[Symbol.toStringTag])return e;let t={...r?.[v]},i=x(Object.values(e).length);const o=new Proxy(t,{get:(s,n)=>n===E?i:n===v?t:t[n]?.valueOf(),set:(s,n,a,l)=>(l=t[n],H(t,n,a),l??++i.value,1),deleteProperty:(s,n)=>(t[n]&&(te(t,n),i.value--),1),ownKeys(){return i.value,Reflect.ownKeys(t)}});for(let s in e){const n=Object.getOwnPropertyDescriptor(e,s);n?.get?(t[s]=M(n.get.bind(o)))._set=n.set?.bind(o):(t[s]=void 0,H(t,s,e[s]))}return o}function me(e){let r;if(e[v])return e;let t=x(e.length),i=Array(e.length).fill();const o=new Proxy(i,{get(s,n){if(typeof n=="symbol")return n===E?t:n===v?i:i[n];if(n==="length")return re[r]?t.peek():t.value;if(r=n,i[n])return i[n].valueOf();if(n<i.length)return(i[n]=x(P(e[n]))).value},set(s,n,a){if(n==="length"){for(let l=a,m=i.length;l<m;l++)delete o[l];return t.value=i.length=a,!0}return H(i,n,a),n>=t.peek()&&(t.value=i.length=Number(n)+1),!0},deleteProperty:(s,n)=>(i[n]&&te(i,n),1)});return o}function H(e,r,t){let i=e[r];if(r[0]==="_")e[r]=t;else if(!i)e[r]=i=t?.peek?t:x(P(t));else if(t!==i.peek())if(i._set)i._set(t);else if(Array.isArray(t)&&Array.isArray(i.peek())){const o=i.peek();o[E]?R(()=>{J(()=>{let s=0,n=t.length;for(;s<n;s++)o[s]=t[s];o.length=n})}):i.value=t}else i.value=P(t)}function te(e,r){const t=e[r],i=t[Symbol.dispose];i&&delete t[Symbol.dispose],delete e[r],i?.()}var v,E,re,X=y({"store.js"(){B(),v=Symbol("signals"),E=Symbol("length"),re={push:1,pop:1,shift:1,unshift:1,splice:1}}});function w(e,r){if(!e?.childNodes)return;if(h in e)return Object.assign(e[h],r);const t=P(r||{}),i=[],o=[];return s(e),h in e||(e[h]=t,e[W]=()=>{for(;i.length;)i.pop()()},e[q]=()=>i.push(...o.map(n=>L(n))),e[Z]=()=>(e[W](),e[W]=e[q]=e[Z]=e[h]=null)),t;function s(n){if(n.childNodes){for(let a=0;a<n.attributes?.length;){let l=n.attributes[a];if(l.name[0]===":"){n.removeAttribute(l.name);for(let m of l.name.slice(1).split(":")){let O=d[m]||d.default,f=O(n,(O.parse||C)(l.value),t,m);if(o.push(f),i.push(L(f)),h in n)return}}else a++}for(let a of[...n.childNodes])s(a)}}}var Z,h,q,W,d,z,C,G,ie,D,b=y({"core.js"(){B(),X(),Z=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),h=Symbol("state"),q=Symbol("on"),W=Symbol("off"),d={},z={},C=(e,r,t)=>{if(t=z[e=e.trim()])return t;try{t=ie(e)}catch(i){G(i,r,e)}return z[e]=t},G=(e,r,t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${r}${t?`="${t}"

`:""}`,expr:t})},w.use=e=>{e.signal&&he(e),e.compile&&(ie=e.compile)},D=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],i=document.createTextNode(""),o=(r.append(i),[...r.childNodes]);return{childNodes:o,content:r,remove:()=>r.append(...o),replaceWith(s){s!==i&&(i.before(s),r.append(...o))},attributes:t,removeAttribute(s){t.splice(t.findIndex(n=>n.name===s),1)},setAttributeNode(){}}}}}),Q,ge=y({"directive/if.js"(){b(),Q=Symbol("if"),d.if=(e,r,t)=>{let i=e.nextElementSibling,o=document.createTextNode(""),s,n,a;return e.replaceWith(o),n=e.content?D(e):e,n[h]=null,i?.hasAttribute(":else")&&(i.removeAttribute(":else"),i.hasAttribute(":if")||(i.remove(),a=i.content?D(i):i,a[h]=null)),()=>{const l=r(t)?n:e[Q]?null:a;i&&(i[Q]=l===n),s!=l&&(s&&(s.remove(),s[W]?.()),(s=l)&&(o.before(s.content||s),s[h]===null&&delete s[h],s[h]?s[q]():w(s,t)))}}}}),ve=y({"directive/each.js"(){b(),X(),B(),d.each=(e,[r,t,i],o)=>{const s=document.createTextNode("");e.replaceWith(s),e[h]=null;let n,a,l=0;const m=M(()=>{a=null;let u=i(o);return typeof u=="number"&&(u=Array.from({length:u},(k,p)=>p+1)),u?.constructor===Object&&(a=Object.keys(u),u=Object.values(u)),u||[]}),O=()=>{R(()=>{var u,k;let p=0,_=m.value,T=_.length;if(n&&!n[E]){for(let S of n[v]||[])S[Symbol.dispose]();n=null,l=0}if(T<l)n.length=T;else{if(!n)n=_;else for(;p<l;p++)n[p]=_[p];for(;p<T;p++){n[p]=_[p];let S=p,Y=P({[r]:n[v]?.[S]||n[S],[t]:a?a[S]:S},o),A=e.content?D(e):e.cloneNode(!0);s.before(A.content||A),w(A,Y),((k=n[u=v]||(n[u]=[]))[p]||(k[p]={}))[Symbol.dispose]=()=>{A[Symbol.dispose]?.(),A.remove()}}}l=T})};let f=0;return()=>{m.value[E]?.value,f++||(O(),queueMicrotask(()=>(f>1&&O(),f=0)))}},d.each.parse=e=>{let[r,t]=e.split(/\s+in\s+/),[i,o="$"]=r.split(/\s*,\s*/);return[i,o,C(t)]}}}),_e=y({"directive/ref.js"(){b(),d.ref=(e,r,t)=>()=>r(t)?.call?.(null,e)}}),je=y({"directive/with.js"(){b(),X(),d.with=(e,r,t)=>{let i;return()=>{let o=r(t);w(e,i?o:i=P(o,t))}}}}),we=y({"directive/text.js"(){b(),d.text=(e,r,t)=>(e.content&&e.replaceWith(e=D(e).childNodes[0]),()=>{let i=r(t);e.textContent=i??""})}}),Oe=y({"directive/class.js"(){b(),d.class=(e,r,t)=>{let i=new Set;return()=>{let o=r(t),s=new Set;o&&(typeof o=="string"?o.split(" ").map(n=>s.add(n)):Array.isArray(o)?o.map(n=>n&&s.add(n)):Object.entries(o).map(([n,a])=>a&&s.add(n)));for(let n of i)s.has(n)?s.delete(n):e.classList.remove(n);for(let n of i=s)e.classList.add(n)}}}}),Se=y({"directive/style.js"(){b(),d.style=(e,r,t)=>{let i=e.getAttribute("style");return()=>{let o=r(t);if(typeof o=="string")e.setAttribute("style",i+(i.endsWith(";")?"":"; ")+o);else{i&&e.setAttribute("style",i);for(let s in o)s[0]=="-"?e.style.setProperty(s,o[s]):e.style[s]=o[s]}}}}}),ne,c,K,oe,se,U,V=y({"directive/default.js"(){b(),d.default=(e,r,t,i)=>{if(!i.startsWith("on"))return()=>{let f=r(t);if(i)K(e,i,f);else for(let u in f)K(e,U(u),f[u])};const o=i.split("..").map(f=>{let u={evt:"",target:e,test:()=>!0};return u.evt=(f.startsWith("on")?f.slice(2):f).replace(/\.(\w+)?-?([-\w]+)?/g,(k,p,_="")=>(u.test=ne[p]?.(u,..._.split("-"))||u.test,"")),u});if(o.length==1)return()=>O(r(t),o[0]);let s,n,a,l=0;const m=f=>{a=O(u=>(a(),n=f?.(u),(l=++l%o.length)?m(n):s&&m(s)),o[l])};return()=>(s=r(t),!a&&m(s),()=>s=null);function O(f,{evt:u,target:k,test:p,defer:_,stop:T,prevent:S,immediate:Y,...A}){_&&(f=_(f));const ce=I=>{try{p(I)&&(T&&(Y?I.stopImmediatePropagation():I.stopPropagation()),S&&I.preventDefault(),f?.call(t,I))}catch(Te){G(Te,`:on${u}`,f)}};return k.addEventListener(u,ce,A),()=>k.removeEventListener(u,ce,A)}},ne={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,r){e.defer=t=>oe(t,r?Number(r)||0:108)},debounce(e,r){e.defer=t=>se(t,r?Number(r)||0:108)},outside:e=>r=>{let t=e.target;return!(t.contains(r.target)||r.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>r=>r.target===e.target,ctrl:(e,...r)=>t=>c.ctrl(t)&&r.every(i=>c[i]?c[i](t):t.key===i),shift:(e,...r)=>t=>c.shift(t)&&r.every(i=>c[i]?c[i](t):t.key===i),alt:(e,...r)=>t=>c.alt(t)&&r.every(i=>c[i]?c[i](t):t.key===i),meta:(e,...r)=>t=>c.meta(t)&&r.every(i=>c[i]?c[i](t):t.key===i),arrow:()=>c.arrow,enter:()=>c.enter,esc:()=>c.esc,tab:()=>c.tab,space:()=>c.space,delete:()=>c.delete,digit:()=>c.digit,letter:()=>c.letter,char:()=>c.char},c={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},K=(e,r,t)=>{t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},oe=(e,r)=>{let t,i,o=s=>{t=!0,setTimeout(()=>{if(t=!1,i)return i=!1,o(s),e(s)},r)};return s=>t?i=!0:(o(s),e(s))},se=(e,r)=>{let t;return i=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(i)},r)}},U=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase())}}),Ae=y({"directive/value.js"(){b(),b(),V(),d.value=(e,[r,t],i)=>{const o=e.type==="text"||e.type===""?n=>e.setAttribute("value",e.value=n??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(n,a,l)=>(a=e.selectionStart,l=e.selectionEnd,e.setAttribute("value",e.value=n??""),a&&e.setSelectionRange(a,l)):e.type==="checkbox"?n=>(e.checked=n,K(e,"checked",n)):e.type==="select-one"?n=>{for(let a of e.options)a.value==n?a.setAttribute("selected",""):a.removeAttribute("selected");e.value=n}:e.type==="select-multiple"?n=>{for(let a of e.options)a.removeAttribute("selected");for(let a of n)e.querySelector(`[value="${a}"]`).setAttribute("selected","")}:n=>e.value=n,s=e.type==="checkbox"?()=>t(i,e.checked):e.type==="select-multiple"?()=>t(i,[...e.selectedOptions].map(n=>n.value)):n=>t(i,e.selectedIndex<0?null:e.value);return e.oninput=e.onchange=s,e.type?.startsWith("select")&&(new MutationObserver(s).observe(e,{childList:!0,subtree:!0,attributes:!0}),w(e,i)),()=>{o(r(i))}},d.value.parse=e=>{let r=[C(e)];try{const t=C(`${e}=__`);r.push((i,o)=>{i.__=o,t(i,o),delete i.__})}catch{}return r}}}),xe=y({"directive/fx.js"(){b(),d.fx=(e,r,t)=>()=>r(t)}}),ke=y({"directive/aria.js"(){b(),V(),d.aria=(e,r,t)=>{const i=o=>{for(let s in o)K(e,"aria-"+U(s),o[s]==null?null:o[s]+"")};return()=>i(r(t))}}}),Ne=y({"directive/data.js"(){b(),d.data=(e,r,t)=>()=>{let i=r(t);for(let o in i)e.dataset[o]=i[o]}}}),ae={};pe(ae,{default:()=>le});var le,Pe=y({"sprae.js"(){b(),ge(),ve(),_e(),je(),we(),Oe(),Se(),Ae(),xe(),V(),ke(),Ne(),w.use({compile:e=>w.constructor(`with (arguments[0]) { return ${e} };`)}),le=w}}),{default:ue}=(Pe(),be(ae));if(g.exports=ue,document.currentScript?.hasAttribute("init")){const e=JSON.parse(document.currentScript?.getAttribute("init")||"{}"),r=()=>{ue(document.documentElement,e)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r()}if(typeof g.exports=="object"&&typeof $=="object"){var Ee=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Object.getOwnPropertyNames(r))!Object.prototype.hasOwnProperty.call(e,o)&&o!==t&&Object.defineProperty(e,o,{get:()=>r[o],enumerable:!(i=Object.getOwnPropertyDescriptor(r,o))||i.enumerable});return e};g.exports=Ee(g.exports,$)}return g.exports});
