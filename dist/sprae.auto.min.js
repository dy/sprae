(function(L,_){typeof exports=="object"&&typeof module=="object"?module.exports=_():typeof define=="function"&&define.amd?define("sprae",[],_):typeof exports=="object"?exports.sprae=_():L.sprae=_()})(typeof self<"u"?self:typeof globalThis<"u"?globalThis:void 0,()=>{var L={},_={exports:L},U=Object.defineProperty,ve=Object.getOwnPropertyDescriptor,le=Object.getOwnPropertyNames,je=Object.prototype.hasOwnProperty,d=(e,r)=>function(){return e&&(r=(0,e[le(e)[0]])(e=0)),r},ue=(e,r)=>{for(var t in r)U(e,t,{get:r[t],enumerable:!0})},Oe=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of le(r))!je.call(e,s)&&s!==t&&U(e,s,{get:()=>r[s],enumerable:!(i=ve(r,s))||i.enumerable});return e},ce=e=>Oe(U({},"__esModule",{value:!0}),e),C,A,N,Y,D,q,fe,T=d({"signal.js"(){A=(e,r,t=new Set)=>(r={get value(){return C?.deps.push(t.add(C)),e},set value(i){if(i!==e){e=i;for(let s of t)s()}},peek(){return e}},r.toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),N=(e,r,t,i)=>(t=s=>{r?.call?.(),s=C,C=t;try{r=e()}finally{C=s}},i=t.deps=[],t(),s=>{for(r?.call?.();s=i.pop();)s.delete(t)}),Y=(e,r=A(),t,i)=>(t={get value(){return i||(i=N(()=>r.value=e())),r.value},peek:r.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),D=e=>e(),q=D,fe=e=>(A=e.signal,N=e.effect,Y=e.computed,D=e.batch||D,q=e.untracked||q)}}),de={};ue(de,{_change:()=>S,_signals:()=>v,_stash:()=>$,default:()=>B,list:()=>ee,setter:()=>V,store:()=>k});var v,S,$,k,ee,pe,F,V,B,E=d({"store.js"(){T(),y(),v=Symbol("signals"),S=Symbol("change"),$="__",k=(e,r)=>{if(!e||e[v]||e[Symbol.toStringTag])return e;if(e.constructor!==Object)return Array.isArray(e)?ee(e):e;let t=Object.create(r?.[v]||{}),i=A(Object.keys(e).length),s,o=new Proxy(t,{get:(u,a)=>a===S?i:a===v?t:a===$?s:a in t?t[a]?.valueOf():globalThis[a],set:(u,a,h,m)=>a===$?(s=h,1):(m=a in t,F(t,a,h),m||++i.value),deleteProperty:(u,a)=>(t[a]&&(t[a][Symbol.dispose]?.(),delete t[a],i.value--),1),ownKeys:()=>(i.value,Reflect.ownKeys(t)),has:u=>!0}),n=Object.getOwnPropertyDescriptors(e);for(let u in e)n[u]?.get?(t[u]=Y(n[u].get.bind(o)))._set=n[u].set?.bind(o):(t[u]=null,F(t,u,e[u]));return o},ee=e=>{let r,t=A(e.length),i=Array(e.length).fill(),s=new Proxy(i,{get(o,n){return typeof n=="symbol"?n===S?t:n===v?i:i[n]:n==="length"?pe.includes(r)?t.peek():t.value:(r=n,(i[n]??(i[n]=A(k(e[n])))).valueOf())},set(o,n,u){if(n==="length"){for(let a=u;a<i.length;a++)delete s[a];t.value=i.length=u}else F(i,n,u),n>=t.peek()&&(t.value=i.length=+n+1);return 1},deleteProperty:(o,n)=>(i[n]?.[Symbol.dispose]?.(),delete i[n],1)});return s},pe=["push","pop","shift","unshift","splice"],F=(e,r,t)=>{let i=e[r],s;r[0]==="_"?e[r]=t:i?t===(s=i.peek())||(i._set?i._set(t):Array.isArray(t)&&Array.isArray(s)?s[S]?D(()=>{for(let o=0;o<t.length;o++)s[o]=t[o];s.length=t.length}):i.value=t:i.value=k(t)):e[r]=i=t?.peek?t:A(k(t))},V=(e,r=W(`${e}=${$}`))=>(t,i)=>(t[$]=i,r(t)),B=k}}),te,g,H,K,X,b,re,W,ie,Z,ye,z,I,O,y=d({"core.js"(){T(),E(),te=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),g=Symbol("state"),H=Symbol("on"),K=Symbol("off"),X={},b=(e,r,t=W)=>X[e]=(i,s,o,n,u,a)=>(u=r(i,o,s,n),a=t(s,":"+n),()=>u(a(o))),re=(e=document.body,r)=>{if(e[g])return Object.assign(e[g],r);let t=k(r||{}),i=[],s=[],o=(n,u=n.attributes)=>{if(u)for(let a=0;a<u.length;){let{name:h,value:m}=u[a],l,c;if(h.startsWith(z)){n.removeAttribute(h);for(c of h.slice(z.length).split(":"))if(l=(X[c]||X.default)(n,m,t,c),s.push(l),i.push(N(l)),n[g]===null)return}else a++}for(let a of n.childNodes)a.nodeType==1&&o(a)};return o(e),g in e||(e[g]=t,e[K]=()=>(i.map(n=>n()),i=[]),e[H]=()=>i=s.map(n=>N(n)),e[te]=()=>(e[K](),e[K]=e[H]=e[te]=e[g]=null)),t},re.use=e=>(e.signal&&fe(e),e.compile&&(ye=e.compile),e.prefix&&(z=e.prefix)),W=(e,r,t)=>{if(t=ie[e=e.trim()])return t;try{t=ye(e)}catch(i){Z(i,r,e)}return ie[e]=i=>{try{return t(i)}catch(s){Z(s,r,e)}}},ie={},Z=(e,r="",t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${r}${t?`="${t}"

`:""}`,expr:t})},z=":",I=e=>{if(!e.nodeType)return e;let r=e.content.cloneNode(!0),t=[...e.attributes],i=document.createTextNode(""),s=(r.append(i),[...r.childNodes]);return{childNodes:s,content:r,remove:()=>r.append(...s),replaceWith(o){o!==i&&(i.before(o),r.append(...s))},attributes:t,removeAttribute(o){t.splice(t.findIndex(n=>n.name===o),1)}}},O=re}}),G,we=d({"directive/if.js"(){y(),G=Symbol("if"),b("if",(e,r)=>{let t=document.createTextNode(""),i=e.nextElementSibling,s,o,n;return e.replaceWith(t),o=e.content?I(e):e,o[g]=null,i?.hasAttribute(":else")?(i.removeAttribute(":else"),i.hasAttribute(":if")||(i.remove(),n=i.content?I(i):i,n[g]=null)):i=null,(u,a=e[G]?null:u?o:n)=>{i&&(i[G]=e[G]||a==o),s!=a&&(s&&(s.remove(),s[K]?.()),(s=a)&&(t.before(s.content||s),s[g]===null?(delete s[g],O(s,r)):s[H]()))}})}}),xe=d({"directive/each.js"(){y(),E(),T(),b("each",(e,r,t)=>{let[i,s="$"]=t.split(/\bin\b/)[0].trim().split(/\s*,\s*/),o=document.createTextNode(""),n,u,a,h=0,m=()=>{var l,c;let p=0,j=a,w=j.length;if(n&&!n[S]){for(let x of n[v]||[])x[Symbol.dispose]();n=null,h=0}if(w<h)n.length=w;else{if(!n)n=j;else for(;p<h;)n[p]=j[p++];for(;p<w;p++){n[p]=j[p];let x=p,oe=B({[i]:n[v]?.[x]||n[x],[s]:u?u[x]:x},r),P=e.content?I(e):e.cloneNode(!0);o.before(P.content||P),O(P,oe);let Q=((c=n[l=v]||(n[l]=[]))[p]||(c[p]={}))[Symbol.dispose];n[v][p][Symbol.dispose]=()=>{Q?.(),P[Symbol.dispose]?.(),P.remove()}}}h=w};return e.replaceWith(o),e[g]=null,l=>{u=null,typeof l=="number"?a=Array.from({length:l},(p,j)=>j+1):l?.constructor===Object?(u=Object.keys(l),a=Object.values(l)):a=l||[];let c=0;return N(()=>{a[S]?.value,c++||(m(),queueMicrotask(()=>(c>1&&m(),c=0)))})}},e=>W(e.split(/\bin\b/)[1]))}}),Ae=d({"directive/ref.js"(){y(),T(),E(),b("ref",(e,r,t)=>typeof W(t)(r)=="function"?i=>i.call(null,e):(V(t)(r,e),i=>i))}}),Se=d({"directive/with.js"(){y(),T(),E(),b("with",(e,r,t)=>(t=null,i=>t?O(e,i):q(()=>O(e,t=B(i,r)))))}}),ke=d({"directive/text.js"(){y(),b("text",e=>(e.content&&e.replaceWith(e=I(e).childNodes[0]),r=>e.textContent=r??""))}}),Pe=d({"directive/class.js"(){y(),b("class",(e,r)=>(r=new Set,t=>{let i=new Set;t&&(typeof t=="string"?t.split(" ").map(s=>i.add(s)):Array.isArray(t)?t.map(s=>s&&i.add(s)):Object.entries(t).map(([s,o])=>o&&i.add(s)));for(let s of r)i.has(s)?i.delete(s):e.classList.remove(s);for(let s of r=i)e.classList.add(s)}))}}),Ne=d({"directive/style.js"(){y(),b("style",(e,r)=>(r=e.getAttribute("style"),t=>{if(typeof t=="string")e.setAttribute("style",r+(r.endsWith(";")?"":"; ")+t);else{r&&e.setAttribute("style",r);for(let i in t)i[0]=="-"?e.style.setProperty(i,t[i]):e.style[i]=t[i]}}))}}),he,f,be,ge,M,se,ne=d({"directive/default.js"(){y(),b("default",(e,r,t,i)=>{if(!i.startsWith("on"))return i?l=>M(e,i,l):l=>{for(let c in l)M(e,se(c),l[c])};let s=i.split("..").map(l=>{let c={evt:"",target:e,test:()=>!0};return c.evt=(l.startsWith("on")?l.slice(2):l).replace(/\.(\w+)?-?([-\w]+)?/g,(p,j,w="")=>(c.test=he[j]?.(c,...w.split("-"))||c.test,"")),c}),o=(l,{evt:c,target:p,test:j,defer:w,stop:x,prevent:oe,immediate:P,...Q},ae)=>(w&&(l=w(l)),ae=R=>{try{j(R)&&(x&&(P?R.stopImmediatePropagation():R.stopPropagation()),oe&&R.preventDefault(),l?.call(r,R))}catch(De){Z(De,`:on${c}`,l)}},p.addEventListener(c,ae,Q),()=>p.removeEventListener(c,ae,Q));if(s.length==1)return l=>o(l,s[0]);let n,u,a,h=0,m=l=>{a=o(c=>(a(),u=l?.(c),(h=++h%s.length)?m(u):n&&m(n)),s[h])};return l=>(n=l,!a&&m(n),()=>n=null)}),he={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},parent(e){e.target=e.target.parentNode},throttle(e,r=108){e.defer=t=>be(t,r)},debounce(e,r=108){e.defer=t=>ge(t,r)},outside:e=>r=>{let t=e.target;return!(t.contains(r.target)||r.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>r=>r.target===e.target,ctrl:(e,...r)=>t=>f.ctrl(t)&&r.every(i=>f[i]?f[i](t):t.key===i),shift:(e,...r)=>t=>f.shift(t)&&r.every(i=>f[i]?f[i](t):t.key===i),alt:(e,...r)=>t=>f.alt(t)&&r.every(i=>f[i]?f[i](t):t.key===i),meta:(e,...r)=>t=>f.meta(t)&&r.every(i=>f[i]?f[i](t):t.key===i),arrow:()=>f.arrow,enter:()=>f.enter,esc:()=>f.esc,tab:()=>f.tab,space:()=>f.space,delete:()=>f.delete,digit:()=>f.digit,letter:()=>f.letter,char:()=>f.char},f={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},be=(e,r)=>{let t,i,s=o=>{t=!0,setTimeout(()=>{if(t=!1,i)return i=!1,s(o),e(o)},r)};return o=>t?i=!0:(s(o),e(o))},ge=(e,r)=>{let t;return i=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(i)},r)}},M=(e,r,t)=>{t==null||t===!1?e.removeAttribute(r):e.setAttribute(r,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},se=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,t)=>(t?"-":"")+r.toLowerCase())}}),Te=d({"directive/value.js"(){y(),y(),T(),E(),ne(),b("value",(e,r,t)=>{const i=e.type==="text"||e.type===""?s=>e.setAttribute("value",e.value=s??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(s,o,n)=>(o=e.selectionStart,n=e.selectionEnd,e.setAttribute("value",e.value=s??""),o&&e.setSelectionRange(o,n)):e.type==="checkbox"?s=>(e.checked=s,M(e,"checked",s)):e.type==="select-one"?s=>{for(let o of e.options)o.value==s?o.setAttribute("selected",""):o.removeAttribute("selected");e.value=s}:e.type==="select-multiple"?s=>{for(let o of e.options)o.removeAttribute("selected");for(let o of s)e.querySelector(`[value="${o}"]`).setAttribute("selected","")}:s=>e.value=s;try{const s=V(t),o=e.type==="checkbox"?()=>s(r,e.checked):e.type==="select-multiple"?()=>s(r,[...e.selectedOptions].map(n=>n.value)):()=>s(r,e.selectedIndex<0?null:e.value);e.oninput=e.onchange=o,e.type?.startsWith("select")&&(new MutationObserver(o).observe(e,{childList:!0,subtree:!0,attributes:!0}),O(e,r)),W(t)(r)??o()}catch{}return i})}}),$e=d({"directive/fx.js"(){y(),b("fx",e=>r=>r)}}),Ee=d({"directive/aria.js"(){y(),ne(),b("aria",e=>r=>{for(let t in r)M(e,"aria-"+se(t),r[t]==null?null:r[t]+"")})}}),We=d({"directive/data.js"(){y(),b("data",e=>r=>{for(let t in r)e.dataset[t]=r[t]})}}),me={};ue(me,{default:()=>_e});var _e,Le=d({"sprae.js"(){y(),we(),xe(),Ae(),Se(),ke(),Pe(),Ne(),Te(),$e(),ne(),Ee(),We(),O.use({compile:e=>O.constructor(`with (arguments[0]) { return ${e} };`)}),_e=O}}),J=(Le(),ce(me)).default;if(J.store=(E(),ce(de)).default,J.use({prefix:document.currentScript.getAttribute("prefix")}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>J()):J(),_.exports=J,typeof _.exports=="object"&&typeof L=="object"){var Ce=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Object.getOwnPropertyNames(r))!Object.prototype.hasOwnProperty.call(e,s)&&s!==t&&Object.defineProperty(e,s,{get:()=>r[s],enumerable:!(i=Object.getOwnPropertyDescriptor(r,s))||i.enumerable});return e};_.exports=Ce(_.exports,L)}return _.exports});
