(function (g, f) {if ("object" == typeof exports && "object" == typeof module) {module.exports = f();} else if ("function" == typeof define && define.amd) {define("sprae", [], f);} else if ("object" == typeof exports) {exports["sprae"] = f();} else {g["sprae"] = f();}}(typeof self !== 'undefined' ? self : typeof globalThis !== 'undefined' ? globalThis : this, () => {var exports = {};var module = { exports };
var tt=Object.defineProperty;var Qt=Object.getOwnPropertyDescriptor;var Ut=Object.getOwnPropertyNames;var Yt=Object.prototype.hasOwnProperty;var m=(t,r)=>()=>(t&&(r=t(t=0)),r);var vt=(t,r)=>{for(var e in r)tt(t,e,{get:r[e],enumerable:!0})},_t=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Ut(r))!Yt.call(t,o)&&o!==e&&tt(t,o,{get:()=>r[o],enumerable:!(n=Qt(r,o))||n.enumerable});return t};var te=t=>_t(tt({},"__esModule",{value:!0}),t);var Z,l,z,F,et,w,T,J,ot,G,V,D,B,rt,mt,ee,Q,nt,yt,O,dt,re,j,b,ht,x,st,C,bt,p,h=m(()=>{U();U();Z=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),l=Symbol("state"),z=Symbol("on"),F=Symbol("off"),et=Symbol("add"),w=":",G=t=>t(),V=G,D={},B={},rt=null,mt=(t=document.body,r)=>{if(t[l])return Object.assign(t[l],r);r=L(r||{});let e=[],n=[],o,s=()=>!n&&(n=e.map(a=>a())),i=()=>(n?.map(a=>a()),n=null);t[z]=s,t[F]=i,t[Z]||(t[Z]=()=>(t[F](),t[F]=t[z]=t[Z]=t[l]=t[et]=null));let c=(a,f=a.attributes)=>{if(f)for(let d=0;d<f.length;){let{name:u,value:y}=f[d];if(u.startsWith(w)){if(a.removeAttribute(u),e.push(o=ee(a,u,y,r)),n.push(o()),l in a)return}else d++}for(let d of[...a.childNodes])d.nodeType==1&&c(d)};return t[et]=c,c(t),t[l]===void 0&&(t[l]=r),r},ee=(t,r,e,n)=>{let o,s,i=r.slice(w.length).split("..").map((c,a,{length:f})=>c.split(w).reduce((d,u)=>{let[y,...g]=u.split("."),W=O(e,D[rt=y]?.parse);if(y.startsWith("on")){let E=y.slice(2),pt=M=>b(W(n),M),R=dt(Object.assign(f==1?pt:M=>(o=(a?o:pt)(M),s(),s=i[(a+1)%f]()),{target:t,type:E}),g);return M=>(M=d?.(),R.target.addEventListener(E,R,R),()=>(M?.(),R.target.removeEventListener(E,R)))}let $=(D[y]||D["*"])(t,n,e,y);if(!g.length&&!d)return()=>$&&J(()=>W(n,$));let S,q=T(-1),A=-1,X=C(dt(()=>{++q.value||(S=J(()=>$&&(q.value==A?X():(A=q.value,W(n,$)))))},g));return E=>(E=d?.(),X(),{[y]:()=>(E?.(),S(),q.value=-1,A=S=null)}[y])},null));return()=>s=i[0]()},Q=t=>(t.compile&&(yt=t.compile),t.prefix&&(w=t.prefix),t.signal&&(T=t.signal),t.effect&&(J=t.effect),t.computed&&(ot=t.computed),t.batch&&(G=t.batch),t.untracked&&(V=t.untracked)),nt=(t=document.body,r)=>{let e=L(r);return mt(t,e),new MutationObserver(o=>{for(let s of o)for(let i of s.addedNodes)if(i.nodeType===1&&i[l]===void 0){for(let c of i.attributes)if(c.name.startsWith(w)){t[et](i);break}}}).observe(t,{childList:!0,subtree:!0}),e},O=(t,r,e)=>{if(e=O.cache[t])return e;let n=t.trim()||"undefined";r&&(n=r(n)),/^(if|let|const)\b/.test(n)||/;/.test(n)||(n=`return ${n}`),/\bawait\s/.test(n)&&(n=`return (async()=>{ ${n} })()`);try{e=yt(n),Object.defineProperty(e,"name",{value:`\u2234 ${t}`})}catch(o){console.error(`\u2234 ${o}

${w+rt}="${t}"`)}return O.cache[t]=(o,s,i)=>{try{let c=e?.(o);return s?(c?.then?c.then(a=>i=s(a)):i=s(c),()=>b(i)):c}catch(c){console.error(`\u2234 ${c}

${w+rt}="${t}"`)}}};O.cache={};dt=(t,r)=>{for(;r.length;){let[e,...n]=r.pop().split("-");t=re(B[e]?.(t,...n)??t,t)}return t},re=(t,r)=>{if(t!=r)for(let e in r)t[e]??(t[e]=r[e]);return t},j=t=>{if(!t.nodeType)return t;let r=t.content.cloneNode(!0),e=[...t.attributes],n=document.createTextNode(""),o=(r.append(n),[...r.childNodes]);return{childNodes:o,content:r,remove:()=>r.append(...o),replaceWith(s){s!==n&&(n.before(s),r.append(...o))},attributes:e,removeAttribute(s){e.splice(e.findIndex(i=>i.name===s),1)}}},b=(t,r)=>typeof t=="function"?t(r):t,ht=t=>t.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(r,e)=>(e?"-":"")+r.toLowerCase()),x=(t,r,e)=>e==null||e===!1?t.removeAttribute(r):t.setAttribute(r,e===!0?"":e),st=(t,r=[])=>t?typeof t=="string"?t:(Array.isArray(t)?t.map(st):Object.entries(t).reduce((e,[n,o])=>o?[...e,n]:e,[])).join(" "):"",C=(t,r=queueMicrotask)=>{let e=0,n=o=>{e++||(t(o),r((s=e>1)=>(e=0,s&&n(o))))};return n},bt=(t,r=queueMicrotask,e=0)=>(n,o=++e)=>r(()=>o==e&&t(n)),p=mt});var P,k,it,K,oe,Y,gt,L,U=m(()=>{h();P=Symbol("signals"),k=Symbol("change"),it=Symbol("set"),K=(t,r=globalThis)=>{if(!t||t[Symbol.toStringTag]||t[P])return t;if(t.constructor!==Object)return Array.isArray(t)?oe(t):t;let e=Object.keys(t).length,n={},o=new Proxy(Object.assign(n,{[k]:T(e),[P]:n}),{get:(i,c)=>c in n?n[c]?n[c].valueOf():n[c]:r[c],set:(i,c,a,f)=>(c in n?gt(n,c,a):(Y(n,c,a),n[k].value=++e),1),deleteProperty:(i,c)=>(c in n&&(c[0]!="_"&&n[c]?.[Symbol.dispose]?.(),delete n[c],n[k].value=--e),1),ownKeys:()=>(n[k].value,Reflect.ownKeys(n)),has:i=>1}),s=Object.getOwnPropertyDescriptors(t);for(let i in t)s[i]?.get?(n[i]=ot(s[i].get.bind(o)))[it]=s[i].set?.bind(o):Y(n,i,t[i]);return o},oe=(t,r=globalThis)=>{let e=Array(t.length).fill(null),n=!1,o=c=>function(){return n=!0,c.apply(this,arguments)},s=T(t.length),i=new Proxy(Object.assign(e,{[k]:s,[P]:e,push:o(e.push),pop:o(e.pop),shift:o(e.shift),unshift:o(e.unshift),splice:o(e.splice)}),{get(c,a){return a==="length"?n?(n=!1,e.length):s.value:typeof a=="symbol"||isNaN(a)?e[a]?.valueOf()??r[a]:(e[a]??(e[a]=T(K(t[a])))).valueOf()},set(c,a,f){if(a==="length"){for(let d=f;d<e.length;d++)delete i[d];s.value=e.length=f}else a>=e.length?(Y(e,a,f),i.length=+a+1):e[a]?gt(e,a,f):Y(e,a,f);return 1},deleteProperty:(c,a)=>(e[a]?.[Symbol.dispose]?.(),delete e[a],1)});return i},Y=(t,r,e)=>t[r]=r[0]=="_"||e?.peek?e:T(K(e)),gt=(t,r,e,n,o)=>r[0]==="_"?t[r]=e:e!==(o=(n=t[r]).peek())&&(n[it]?n[it](e):Array.isArray(e)&&Array.isArray(o)?k in o?V(()=>G(()=>{for(let s=0;s<e.length;s++)o[s]=e[s];o.length=e.length})):n.value=e:n.value=K(e)),L=K});var N,xt,I,v,_,at,ct,ut,St=m(()=>{xt=0,v=(t,r,e=new Set,n=()=>r.value)=>r={get value(){return N?.deps.push(e.add(N)),t},set value(o){if(o!==t){t=o;for(let s of e)I?I.add(s):s()}},peek(){return t},toJSON:n,then:n,toString:n,valueOf:n},_=(t,r,e,n,o)=>(e=s=>{if(o=r,r=null,o?.call?.(),s=N,N=e,xt++>10)throw"Cycle detected";try{r=t()}finally{N=s,xt--}},n=e.deps=[],e(),s=>{for(r?.call?.();s=n.pop();)s.delete(e)}),at=(t,r=v(),e,n,o=()=>e.value)=>e={get value(){return n||(n=_(()=>r.value=t())),r.value},peek:r.peek,toJSON:o,then:o,toString:o,valueOf:o},ct=(t,r=!I)=>{I??(I=new Set);try{t()}finally{if(r){for(let e of I)e();I=null}}},ut=(t,r,e)=>(r=N,N=null,e=t(),N=r,e)});var At,Ot=m(()=>{h();At=(t,r,e,n,o)=>{var s;return t._holder?p(n=t,r):(t[s=l]??(t[s]=null),n=t.content?j(t):t,t.replaceWith(e=document.createTextNode("")),n._holder=e._holder=e,e._clauses=[n._clause=[n,!1]],e.update=C(()=>{let i=e._clauses.find(([,c])=>c);i!=o&&(o?.[0].remove(),o?.[0][F]?.(),(o=i)&&(e.before(o[0].content||o[0]),o[0][l]?o[0][z]?.():(delete o[0][l],p(o[0],r))))})),i=>{n._clause[1]=i,n._holder.update()}}});var kt,jt=m(()=>{h();kt=(t,r,e,n,o=t)=>{for(e=t.content?j(t):t;o&&!(e._holder=o._holder);)o=o.previousSibling;return t.remove(),t[l]=null,e._holder._clauses.push(e._clause=[e,!0]),()=>{e._holder.update()}}});var Nt,$t=m(()=>{h();Nt=t=>(t.content&&t.replaceWith(t=j(t).childNodes[0]),r=>(r=b(r,t.textContent),t.textContent=r??""))});var wt,Tt=m(()=>{h();wt=(t,r,e)=>(r=new Set,n=>{e=new Set,n&&st(b(n,t.className)).split(" ").map(o=>o&&e.add(o));for(let o of r)e.has(o)?e.delete(o):t.classList.remove(o);for(let o of r=e)t.classList.add(o)})});var Ct,Pt=m(()=>{h();Ct=(t,r)=>(r=t.getAttribute("style"),e=>{if(e=b(e,t.style),typeof e=="string")x(t,"style",r+"; "+e);else{r&&x(t,"style",r);for(let n in e)n[0]=="-"?t.style.setProperty(n,e[n]):n[0]>"A"&&(t.style[n]=e[n])}})});var Wt,qt=m(()=>{h();Wt=()=>t=>b(t)});var ne,Et,Mt=m(()=>{h();ne=(t,r=O(`${t}=__`))=>(e,n)=>{e.__=n,r(e),delete e.__},Et=(t,r,e,n)=>{try{let o=ne(e),s=t.type==="checkbox"?()=>o(r,t.checked):t.type==="select-multiple"?()=>o(r,[...t.selectedOptions].map(i=>i.value)):()=>o(r,t.selectedIndex<0?null:t.value);t.oninput=t.onchange=s,t.type?.startsWith("select")&&(new MutationObserver(s).observe(t,{childList:!0,subtree:!0,attributes:!0}),p(t,r)),O(e)(r)??s()}catch{}return t.type==="text"||t.type===""?o=>t.setAttribute("value",t.value=o??""):t.tagName==="TEXTAREA"||t.type==="text"||t.type===""?(o,s,i)=>(s=t.selectionStart,i=t.selectionEnd,t.setAttribute("value",t.value=o??""),s&&t.setSelectionRange(s,i)):t.type==="checkbox"?o=>(t.checked=o,x(t,"checked",o)):t.type==="radio"?o=>t.value===o&&(t.checked=o,x(t,"checked",o)):t.type==="select-one"?o=>{for(let s of t.options)s.value==o?s.setAttribute("selected",""):s.removeAttribute("selected");t.value=o}:t.type==="select-multiple"?o=>{for(let s of t.options)s.removeAttribute("selected");for(let s of o)t.querySelector(`[value="${s}"]`).setAttribute("selected","")}:o=>t.value=o}});var Dt,Lt=m(()=>{h();Dt=(t,r,e,n,o,s)=>typeof O(e)(r)=="function"?i=>i(t):(Object.defineProperty(r,e,{value:t,configurable:!0}),()=>{})});var Kt,It=m(()=>{h();Kt=(t,r,e)=>(t[l]=null,e=K({},r),n=>{let o=b(n,e);for(let s in o)e[s]=typeof o[s]=="function"?o[s].bind(e):o[s];return t[l]??(delete t[l],V(()=>p(t,e)))})});var Rt,Ft,Jt=m(()=>{h();Rt=(t,r,e)=>{let[n,o="$"]=e.split(/\bin\b/)[0].trim().replace(/\(|\)/g,"").split(/\s*,\s*/),s=document.createTextNode(""),i,c,a,f=0,d=C(()=>{var W,$;let u=0,y=a,g=y.length;if(i&&!i[k]){for(let S of i[P]||[])S[Symbol.dispose]();i=null,f=0}if(g<f)i.length=g;else{if(!i)i=y;else for(;u<f;)i[u]=y[u++];for(;u<g;u++){i[u]=y[u];let S=u,q=Object.create(r,{[n]:{get:()=>i[S]},[o]:{value:c?c[S]:S}}),A=t.content?j(t):t.cloneNode(!0);s.before(A.content||A),p(A,q);let X=(($=i[W=P]||(i[W]=[]))[u]||($[u]={}))[Symbol.dispose];i[P][u][Symbol.dispose]=()=>{X?.(),A[Symbol.dispose]?.(),A.remove()}}}f=g});return t.replaceWith(s),t[l]=null,u=>(c=null,typeof u=="number"?a=Array.from({length:u},(y,g)=>g+1):u?.constructor===Object?(c=Object.keys(u),a=Object.values(u)):a=u||[],J(()=>{a[k]?.value,d()}))};Rt.parse=t=>t.split(/\bin\b/)[1].trim();Ft=Rt});var Vt,Bt=m(()=>{h();Vt=(t,r,e,n)=>o=>x(t,n,b(o,t.getAttribute(n)))});var Ht,Xt=m(()=>{h();Ht=t=>r=>{for(let e in r)x(t,ht(e),r[e])}});var Zt={};vt(Zt,{batch:()=>ct,computed:()=>at,default:()=>se,effect:()=>_,signal:()=>v,sprae:()=>p,start:()=>nt,store:()=>L,untracked:()=>ut,use:()=>Q});var lt,se,zt=m(()=>{U();St();h();Ot();jt();$t();Tt();Pt();qt();Mt();Lt();It();Jt();Bt();Xt();Object.assign(D,{"*":Vt,"":Ht,class:wt,text:Nt,style:Ct,fx:Wt,value:Et,ref:Dt,scope:Kt,if:At,else:kt,each:Ft});Object.assign(B,{debounce:(t,r=250,e=r==="tick"?queueMicrotask:r==="raf"?requestAnimationFrame:r==="idle"?requestIdleCallback:o=>setTimeout(o,r),n=0)=>bt(t,e),throttle:(t,r=250,e=r==="tick"?queueMicrotask:r==="raf"?requestAnimationFrame:n=>setTimeout(n,r))=>C(t,e),once:(t,r,e)=>Object.assign(n=>!r&&(r=1,t(n)),{once:!0}),prevent:t=>r=>(r?.preventDefault(),t(r)),stop:t=>r=>(r?.stopPropagation(),t(r)),immediate:t=>r=>(r?.stopImmediatePropagation(),t(r)),passive:t=>(t.passive=!0,t),capture:t=>(t.capture=!0,t),window:t=>(t.target=window,t),document:t=>(t.target=document,t),parent:t=>(t.target=t.target.parentNode,t),self:t=>r=>r.target===t.target&&t(r),outside:t=>(r,e)=>(e=t.target,!e.contains(r.target)&&r.target.isConnected&&(e.offsetWidth||e.offsetHeight))});lt={ctrl:t=>t.ctrlKey||t.key==="Control"||t.key==="Ctrl",shift:t=>t.shiftKey||t.key==="Shift",alt:t=>t.altKey||t.key==="Alt",meta:t=>t.metaKey||t.key==="Meta"||t.key==="Command",arrow:t=>t.key.startsWith("Arrow"),enter:t=>t.key==="Enter",esc:t=>t.key.startsWith("Esc"),tab:t=>t.key==="Tab",space:t=>t.key==="\xA0"||t.key==="Space"||t.key===" ",delete:t=>t.key==="Delete"||t.key==="Backspace",digit:t=>/^\d$/.test(t.key),letter:t=>/^\p{L}$/gu.test(t.key),char:t=>/^\S$/.test(t.key)};for(let t in lt)B[t]=(r,...e)=>n=>lt[t](n)&&e.every(o=>lt[o]?.(n)??n.key===o)&&r(n);Q({compile:t=>p.constructor(`with (arguments[0]) { ${t} }`),signal:v,effect:_,computed:at,batch:ct,untracked:ut});p.use=Q;p.store=L;p.directive=D;p.modifier=B;p.start=nt;se=p});var ft=(zt(),te(Zt)).default;module.exports=ft;var Gt=document.currentScript.getAttribute("prefix")??document.currentScript.dataset.spraePrefix,H=document.currentScript.getAttribute("start")??document.currentScript.dataset.spraeStart;Gt&&ft.use({prefix:Gt});H!=null&&H!=="false"&&(H&&H!=="true"?document.querySelectorAll(H):[document.body]).forEach(t=>ft.start(t));
;if (typeof module.exports == "object" && typeof exports == "object") {
  var __cp = (to, from, except, desc) => {
    if ((from && typeof from === "object") || typeof from === "function") {
      for (let key of Object.getOwnPropertyNames(from)) {
        if (!Object.prototype.hasOwnProperty.call(to, key) && key !== except)
        Object.defineProperty(to, key, {
          get: () => from[key],
          enumerable: !(desc = Object.getOwnPropertyDescriptor(from, key)) || desc.enumerable,
        });
      }
    }
    return to;
  };
  module.exports = __cp(module.exports, exports);
}
return module.exports;
}))
